<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WEBER LESSA CORRETOR & CONSULTORIA DE IMÓVEIS - CRECI: 654/AL</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #1a5276;
            --secondary: #2980b9;
            --accent: #3498db;
            --gold: #f39c12;
            --green: #27ae60;
            --text: #2c3e50;
            --light: #ecf0f1;
            --dark: #2c3e50;
            --success: #27ae60;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--text);
            background: linear-gradient(135deg, #1a5276 0%, #2980b9 100%);
            min-height: 100vh;
        }
        
       /* ========== HEADER COM FUNDO CLARO ========== */
       /* ========== HEADER INTEGRADO COMPACTO ========== */
/* ========== HEADER INTEGRADO COMPACTO ========== */
.header {
    background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
    padding: 8px 0;
    box-shadow: 0 3px 15px rgba(0, 0, 0, 0.05);
    border-bottom: 2px solid #d4af37;
    margin: 0;
    min-height: auto;
}

.header-content {
    max-width: 1400px;
    margin: 0 auto;
    padding: 0 15px;
    height: auto;
}

/* ========== DESKTOP LAYOUT INTEGRADO ========== */
.header-integrated {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    gap: 20px;
    width: 100%;
    padding: 5px 0;
}

/* Lado Esquerdo: Branding */
.brand-section {
    display: flex;
    gap: 15px;
    align-items: flex-start;
    flex: 1;
}

/* Logo Compacta */
.logo {
    position: relative;
    width: 70px;
    height: 70px;
    background: linear-gradient(145deg, #1a5276, #0c2d48);
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 4px 12px rgba(26, 82, 118, 0.2);
    border: 2px solid rgba(212, 175, 55, 0.3);
    flex-shrink: 0;
}

.logo-wl {
    font-family: 'Georgia', serif;
    font-size: 2.2rem;
    font-weight: 900;
    background: linear-gradient(135deg, #ffffff, #f0f0f0);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    letter-spacing: 2px;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
}

.logo-badge {
    position: absolute;
    bottom: -6px;
    right: -6px;
    width: 22px;
    height: 22px;
    background: linear-gradient(135deg, #d4af37, #b8941f);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #ffffff;
    font-size: 0.7rem;
    box-shadow: 0 3px 8px rgba(0, 0, 0, 0.3);
    border: 2px solid #ffffff;
}

/* Informações da Marca */
.brand-info {
    display: flex;
    flex-direction: column;
    gap: 8px;
    flex: 1;
}

.brand-name-compact {
    display: flex;
    flex-direction: column;
    line-height: 1;
}

.first-name-compact {
    font-family: 'Georgia', serif;
    font-size: 1.8rem;
    font-weight: 900;
    color: #0c2d48;
    letter-spacing: 1px;
    text-transform: uppercase;
    line-height: 1;
}

.last-name-compact {
    font-family: 'Georgia', serif;
    font-size: 1.5rem;
    font-weight: 700;
    color: #1a5276;
    letter-spacing: 1.5px;
    text-transform: uppercase;
    margin-top: -3px;
    line-height: 1;
}

/* CRECI Info Compacta */
.creci-info-compact {
    display: flex;
    align-items: center;
    gap: 10px;
    flex-wrap: wrap;
}

.creci-badge-compact {
    display: flex;
    align-items: center;
    gap: 6px;
    background: #f8f9fa;
    padding: 5px 10px;
    border-radius: 8px;
    border: 1px solid #e9ecef;
}

.creci-badge-compact i {
    color: #1a5276;
    font-size: 0.9rem;
}

.creci-label-compact {
    font-size: 0.7rem;
    color: #6c757d;
    text-transform: uppercase;
    font-weight: 600;
    letter-spacing: 1px;
}

.creci-number-compact {
    font-size: 1rem;
    font-weight: 900;
    color: #0c2d48;
    font-family: 'Courier New', monospace;
    letter-spacing: 1px;
}

.certified-badge-compact {
    display: flex;
    align-items: center;
    gap: 5px;
    background: linear-gradient(135deg, #1a5276, #2980b9);
    padding: 5px 10px;
    border-radius: 8px;
    border: 1px solid #d4af37;
}

.certified-badge-compact i {
    color: #d4af37;
    font-size: 0.8rem;
}

.certified-badge-compact span {
    color: #ffffff;
    font-size: 0.7rem;
    font-weight: 600;
    letter-spacing: 0.8px;
}

/* Especialização Compacta */
.specialty-compact {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-top: 2px;
}

.specialty-compact i {
    color: #1a5276;
    font-size: 1rem;
}

.specialty-title-compact {
    font-size: 0.9rem;
    font-weight: 800;
    color: #1a5276;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.specialty-subtitle-compact {
    font-size: 0.75rem;
    color: #495057;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.8px;
    margin-left: 5px;
}

/* ========== LADO DIREITO: CONTATO E ENDEREÇO ========== */
.contact-section {
    display: flex;
    flex-direction: column;
    gap: 10px;
    min-width: 280px;
    padding-top: 5px;
}

/* Telefone/WhatsApp Compacto */
.phone-whatsapp-compact {
    display: flex;
    align-items: center;
    gap: 10px;
    background: #f8f9fa;
    padding: 10px 15px;
    border-radius: 10px;
    border: 1px solid #e9ecef;
}

.phone-icons-compact {
    display: flex;
    gap: 5px;
}

.phone-icons-compact .fa-mobile-alt {
    color: #1a5276;
    font-size: 1.1rem;
}

.phone-icons-compact .fa-whatsapp {
    color: #25D366;
    font-size: 1.1rem;
}

.phone-number-compact {
    display: flex;
    align-items: baseline;
    gap: 3px;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}

.phone-prefix-compact {
    font-size: 0.9rem;
    color: #6c757d;
    font-weight: 600;
}

.phone-main-compact {
    font-size: 1.2rem;
    font-weight: 700;
    color: #1a5276;
    letter-spacing: 0.5px;
}

/* Endereço Compacto */
.address-compact {
    display: flex;
    gap: 10px;
    background: #f8f9fa;
    padding: 10px 15px;
    border-radius: 10px;
    border: 1px solid #e9ecef;
    align-items: flex-start;
}

.address-compact i {
    color: #d4af37;
    font-size: 1rem;
    margin-top: 2px;
}

.address-text-compact {
    display: flex;
    flex-direction: column;
    gap: 2px;
}

.address-line-1 {
    font-size: 0.85rem;
    font-weight: 700;
    color: #1a5276;
    line-height: 1.2;
}

.address-line-2 {
    font-size: 0.8rem;
    color: #495057;
    line-height: 1.2;
}

.address-line-3 {
    font-size: 0.8rem;
    color: #6c757d;
    font-weight: 600;
    line-height: 1.2;
}

/* ========== MOBILE LAYOUT ULTRA COMPACTO ========== */
.mobile-header-ultimate {
    display: none;
    width: 100%;
    padding: 5px 0;
}

/* Linha 1: Logo + Nome + Telefone */
.mobile-row-1 {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin: 0 0 5px 0;
    padding: 0;
    width: 100%;
}

.mobile-logo-mini {
    width: 40px;
    height: 40px;
    background: linear-gradient(145deg, #1a5276, #0c2d48);
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-family: 'Georgia', serif;
    font-size: 1.2rem;
    font-weight: 900;
    box-shadow: 0 2px 6px rgba(26, 82, 118, 0.2);
    flex-shrink: 0;
}

.mobile-name-mini {
    display: flex;
    flex-direction: column;
    align-items: center;
    flex: 1;
    margin: 0 5px;
}

.mobile-first-name-mini {
    font-family: 'Georgia', serif;
    font-size: 1.2rem;
    font-weight: 900;
    color: #0c2d48;
    letter-spacing: 0.8px;
    text-transform: uppercase;
    line-height: 1;
}

.mobile-last-name-mini {
    font-family: 'Georgia', serif;
    font-size: 1rem;
    font-weight: 700;
    color: #1a5276;
    letter-spacing: 1px;
    text-transform: uppercase;
    line-height: 1;
}

.mobile-phone-mini {
    display: flex;
    gap: 3px;
    flex-shrink: 0;
}

.mobile-phone-mini .fa-mobile-alt {
    color: #1a5276;
    font-size: 0.9rem;
}

.mobile-phone-mini .fa-whatsapp {
    color: #25D366;
    font-size: 0.9rem;
}

/* Linha 2: CRECI + Especialização */
.mobile-row-2 {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin: 3px 0;
    padding: 0;
    width: 100%;
}

.mobile-creci-mini {
    display: flex;
    align-items: center;
    gap: 4px;
    background: #f8f9fa;
    padding: 4px 8px;
    border-radius: 6px;
    font-size: 0.7rem;
    font-weight: 700;
    color: #0c2d48;
}

.mobile-creci-mini i {
    color: #1a5276;
    font-size: 0.7rem;
}

.mobile-specialty-mini {
    display: flex;
    align-items: center;
    gap: 4px;
    font-size: 0.7rem;
    font-weight: 700;
    color: #1a5276;
}

.mobile-specialty-mini i {
    color: #1a5276;
    font-size: 0.7rem;
}

/* Linha 3: Endereço + Certificado */
.mobile-row-3 {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin: 3px 0 0 0;
    padding: 0;
    width: 100%;
}

.mobile-address-mini {
    display: flex;
    align-items: center;
    gap: 4px;
    font-size: 0.65rem;
    color: #495057;
    font-weight: 600;
}

.mobile-address-mini i {
    color: #d4af37;
    font-size: 0.7rem;
}

.mobile-certified-mini {
    display: flex;
    align-items: center;
    gap: 4px;
    background: linear-gradient(135deg, #1a5276, #2980b9);
    padding: 3px 8px;
    border-radius: 6px;
    font-size: 0.6rem;
    color: white;
    font-weight: 600;
}

.mobile-certified-mini i {
    color: #d4af37;
    font-size: 0.6rem;
}

/* ========== MEDIA QUERIES ========== */
@media (max-width: 1024px) {
    .header-integrated {
        gap: 15px;
    }
    
    .contact-section {
        min-width: 250px;
    }
    
    .phone-main-compact {
        font-size: 1.1rem;
    }
    
    .address-line-1 {
        font-size: 0.8rem;
    }
    
    .address-line-2,
    .address-line-3 {
        font-size: 0.75rem;
    }
}

@media (max-width: 768px) {
    .header-integrated {
        display: none;
    }
    
    .mobile-header-ultimate {
        display: block;
    }
    
    .header {
        padding: 5px 0;
    }
    
    .header-content {
        padding: 0 10px;
    }
}

@media (min-width: 769px) {
    .mobile-header-ultimate {
        display: none;
    }
    
    .header-integrated {
        display: flex;
    }
}

/* Ajuste para telas muito pequenas */
@media (max-width: 380px) {
    .mobile-logo-mini {
        width: 35px;
        height: 35px;
        font-size: 1rem;
    }
    
    .mobile-first-name-mini {
        font-size: 1rem;
    }
    
    .mobile-last-name-mini {
        font-size: 0.85rem;
    }
    
    .mobile-creci-mini,
    .mobile-specialty-mini {
        font-size: 0.65rem;
        padding: 3px 6px;
    }
    
    .mobile-address-mini {
        font-size: 0.6rem;
    }
    
    .mobile-certified-mini {
        font-size: 0.55rem;
        padding: 2px 6px;
    }
}
        
        /* Ajuste para desktop médio */
        @media (min-width: 769px) and (max-width: 1024px) {
            .desktop-logo-container .logo {
                width: 60px;
                height: 60px;
            }
            
            .desktop-logo-container .logo-wl {
                font-size: 1.8rem;
            }
            
            .first-name {
                font-size: 1.4rem;
            }
            
            .last-name {
                font-size: 1.1rem;
            }
            
            .creci-number {
                font-size: 0.9rem;
            }
            
            .specialty-title {
                font-size: 0.7rem;
            }
            
            .specialty-subtitle {
                font-size: 0.6rem;
            }
            
            .creci-certified-badge span {
                font-size: 0.6rem;
            }
        }
            
        /* Header e Navegação */
        .header {
            background: rgba(255, 255, 255, 0.98);
            padding: 1.5rem 1rem;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .logo-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .logo {
            width: 60px;
            height: 60px;
            background: linear-gradient(45deg, var(--primary), var(--accent));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.8rem;
            font-weight: bold;
        }
        
        .logo-text h1 {
            color: var(--primary);
            font-size: 1.8rem;
            margin-bottom: 0.2rem;
        }
        
        .logo-text p {
            color: var(--secondary);
            font-size: 1rem;
            font-weight: 500;
        }
        
        .contact-info {
            text-align: right;
        }
        
        .contact-info .phone {
            font-size: 1.3rem;
            font-weight: bold;
            color: var(--primary);
            margin-bottom: 0.3rem;
        }
        
        .contact-info .address {
            font-size: 0.9rem;
            color: var(--dark);
        }
        
        /* Hero Section */
        .hero {
            background: linear-gradient(rgba(26, 82, 118, 0.8), rgba(41, 128, 185, 0.8)), url('https://images.unsplash.com/photo-1544984243-ec57ea16fe25?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80');
            background-size: cover;
            background-position: center;
            color: white;
            text-align: center;
            padding: 4rem 1rem;
        }
        
        .hero h1 {
            font-size: 2.8rem;
            margin-bottom: 1rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .hero p {
            font-size: 1.3rem;
            max-width: 700px;
            margin: 0 auto 2rem;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }
        
        .cta-button {
            display: inline-block;
            background: var(--gold);
            color: white;
            padding: 0.9rem 2rem;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: bold;
            text-decoration: none;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(243, 156, 18, 0.4);
        }
        
        .cta-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(243, 156, 18, 0.6);
        }
        
        /* Serviços Section */
        .services {
            background: white;
            padding: 4rem 1rem;
        }
        
        .section-title {
            text-align: center;
            margin-bottom: 3rem;
        }
        
        .section-title h2 {
            font-size: 2.2rem;
            color: var(--primary);
            margin-bottom: 1rem;
        }
        
        .section-title p {
            color: var(--dark);
            max-width: 700px;
            margin: 0 auto;
            font-size: 1.1rem;
        }
        
        .services-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .service-card {
            background: var(--light);
            border-radius: 10px;
            padding: 2rem;
            text-align: center;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        
        .service-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        
        .service-icon {
            font-size: 2.5rem;
            color: var(--primary);
            margin-bottom: 1.5rem;
        }
        
        .service-card h3 {
            font-size: 1.4rem;
            margin-bottom: 1rem;
            color: var(--primary);
        }
        
        .service-card p {
            color: var(--dark);
        }
        
        /* Imóveis Section */
        .properties {
            padding: 4rem 1rem;
            background: #f8f9fa;
        }
        
        .filters {
            background: white;
            padding: 1.5rem;
            margin: 0 auto 2rem;
            max-width: 1200px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .filter-options {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .filter-btn {
            background: var(--light);
            border: none;
            padding: 0.7rem 1.5rem;
            border-radius: 30px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .filter-btn.active {
            background: var(--primary);
            color: white;
        }
        
        .property-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .property-card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .property-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.15);
        }
        
        .property-image {
            width: 100%;
            height: 250px;
            background: linear-gradient(45deg, var(--accent), var(--secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            position: relative;
            overflow: hidden;
        }
        
        .rural-image {
            background: linear-gradient(45deg, var(--green), #2ecc71);
        }
        
        .property-badge {
            position: absolute;
            top: 15px;
            left: 15px;
            background: var(--gold);
            color: white;
            padding: 0.4rem 1rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
        }
        
        .rural-badge {
            background: var(--green);
        }
        
        .property-content {
            padding: 1.5rem;
        }
        
        .property-price {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary);
            margin-bottom: 0.5rem;
        }
        
        .property-title {
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
            color: var(--text);
        }
        
        .property-location {
            color: #666;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .property-features {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 1rem;
        }
        
        .feature-tag {
            background: var(--accent);
            color: white;
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        .rural-tag {
            background: var(--green);
        }
        
        .contact-btn {
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            color: white;
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            width: 100%;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .contact-btn:hover {
            transform: scale(1.02);
            box-shadow: 0 5px 15px rgba(0, 119, 182, 0.3);
        }
        
        .video-indicator {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 0.3rem 0.6rem;
            border-radius: 15px;
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        /* Sobre Section */
        .about {
            background: white;
            padding: 4rem 1rem;
        }
        
        .about-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            max-width: 1200px;
            margin: 0 auto;
            align-items: center;
        }
        
        .about-text h2 {
            font-size: 2.2rem;
            color: var(--primary);
            margin-bottom: 1.5rem;
        }
        
        .about-text p {
            margin-bottom: 1.5rem;
            font-size: 1.1rem;
            line-height: 1.7;
        }
        
        .about-image {
            background: linear-gradient(45deg, var(--accent), var(--secondary));
            height: 400px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
        }
        
        /* Footer */
        .footer {
            background: var(--dark);
            color: white;
            padding: 3rem 1rem;
        }
        
        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .footer-section h3 {
            font-size: 1.3rem;
            margin-bottom: 1.5rem;
            color: var(--gold);
        }
        
        .footer-section p, .footer-section a {
            color: #bbb;
            margin-bottom: 0.8rem;
            display: block;
            text-decoration: none;
            transition: color 0.3s ease;
        }
        
        .footer-section a:hover {
            color: white;
        }
        
        .social-icons {
            display: flex;
            gap: 15px;
            margin-top: 1rem;
        }
        
        .social-icon {
            width: 40px;
            height: 40px;
            background: rgba(255,255,255,0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }
        
        .social-icon:hover {
            background: var(--accent);
            transform: translateY(-3px);
        }
        
        .copyright {
            text-align: center;
            margin-top: 3rem;
            padding-top: 1.5rem;
            border-top: 1px solid rgba(255,255,255,0.1);
            color: #999;
        }
        
        /* ========== ESTILOS DO PAINEL ADMIN ========== */
        .admin-panel {
            background: #f8f9fa;
            padding: 2rem;
            margin: 2rem auto;
            max-width: 1000px;
            border-radius: 10px;
            display: none;
        }
        
        .admin-toggle {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--primary);
            color: white;
            border: none;
            padding: 1rem;
            border-radius: 50%;
            cursor: pointer;
            z-index: 1000;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            font-size: 1.2rem;
        }
        
        .property-item {
            background: #f5f5f5;
            padding: 1rem;
            margin: 0.5rem 0;
            border-radius: 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-left: 4px solid var(--primary);
        }

        .pdf-access {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(255,255,255,0.9);
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            color: var(--primary);
            transition: all 0.3s ease;
            z-index: 10;
        }

        .pdf-access:hover {
             background: white;
             transform: scale(1.1);
             box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }

        .pdf-modal {
             display: none;
             position: fixed;
             top: 0;
             left: 0;
             width: 100%;
             height: 100%;
             background: rgba(0,0,0,0.8);
             z-index: 1000;
             align-items: center;
             justify-content: center;
        }

        .pdf-modal-content {
              background: white;
              padding: 2rem;
              border-radius: 10px;
              max-width: 400px;
              width: 90%;
              text-align: center;
        }

        .pdf-preview {
              margin: 1rem 0;
              padding: 1rem;
              background: #f8f9fa;
              border-radius: 5px;
        }

        .pdf-file-item {
              display: flex;
              align-items: center;
              gap: 10px;
              padding: 0.5rem;
              margin: 0.5rem 0;
              background: white;
              border-radius: 5px;
              border: 1px solid #ddd;
        }

        .pdf-password-input {
              width: 100%;
              padding: 0.8rem;
              margin: 1rem 0;
              border: 1px solid #ddd;
              border-radius: 5px;
              font-size: 1rem;
        }

       // ========== ADICIONAR CSS PARA OS ELEMENTOS DE UPLOAD ==========
        // Adicione este CSS no estilo existente
        // ========== ADICIONAR ESTILOS CSS ==========
        const additionalCSS = `
        /* ========== DIFERENCIAÇÃO ENTRE PDFs EXISTENTES E NOVOS ========== */
        #existingPdfsSection .image-preview-container {
            border: 2px solid var(--success);
        }
        
        #existingPdfsSection .delete-image-btn {
            background: #e74c3c;
        }
        
        #newPdfsSection .pdf-file-item {
            border: 2px dashed #3498db;
            background: #f8faff;
        }
        
        #newPdfsSection .delete-image-btn {
            background: #3498db;
        }
        
        #newPdfsSection .delete-image-btn:hover {
            background: #2980b9;
        }
        
        /* ========== SEPARAÇÃO VISUAL ========== */
        #existingPdfsSection {
            margin-bottom: 2rem;
            padding-bottom: 1.5rem;
            border-bottom: 2px solid #eee;
        }
        
        #newPdfsSection {
            margin-top: 1rem;
            padding-top: 1.5rem;
        }
        `;
        
        // Adicionar o CSS ao documento
        const style = document.createElement('style');
        style.textContent = additionalCSS;
        document.head.appendChild(style);`
        /* ========== CORREÇÃO PARA ELEMENTOS DE UPLOAD ========== */
        #pdfUploadArea * {
            pointer-events: none;
        }
        
        #pdfUploadArea {
            pointer-events: auto;
        }
        
        .delete-image-btn {
            pointer-events: auto;
        }
        
        .image-preview-container {
            pointer-events: auto;
        }
        
        /* ========== ESTILO PARA PDF PREVIEW ========== */
        .pdf-file-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 0.8rem;
            margin: 0.5rem 0;
            background: white;
            border-radius: 8px;
            border: 1px solid #ddd;
            transition: all 0.3s ease;
        }
        
        .pdf-file-item:hover {
            border-color: var(--accent);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        `;
        
        // Adicionar o CSS ao documento
        const style = document.createElement('style');
        style.textContent = additionalCSS;
        document.head.appendChild(style);

        // ========== ADICIONAR ESTILOS CSS ==========
        const additionalCSS = `
        /* ========== DIFERENCIAÇÃO ENTRE FOTOS EXISTENTES E NOVAS ========== */
        #existingImagesSection .image-preview-container {
            border: 2px solid var(--success);
        }
        
        #existingImagesSection .delete-image-btn {
            background: #e74c3c;
        }
        
        #newImagesSection .image-preview-container {
            border: 2px dashed #3498db;
        }
        
        #newImagesSection .delete-image-btn {
            background: #3498db;
        }
        
        #newImagesSection .delete-image-btn:hover {
            background: #2980b9;
        }
        
        /* ========== DIFERENCIAÇÃO ENTRE PDFs EXISTENTES E NOVOS ========== */
        #existingPdfsSection .image-preview-container {
            border: 2px solid var(--success);
        }
        
        #existingPdfsSection .delete-image-btn {
            background: #e74c3c;
        }
        
        #newPdfsSection .pdf-file-item {
            border: 2px dashed #3498db;
            background: #f8faff;
        }
        
        #newPdfsSection .delete-image-btn {
            background: #3498db;
        }
        
        #newPdfsSection .delete-image-btn:hover {
            background: #2980b9;
        }
        
        /* ========== SEPARAÇÃO VISUAL ========== */
        #existingImagesSection {
            margin-bottom: 2rem;
            padding-bottom: 1.5rem;
            border-bottom: 2px solid #eee;
        }
        
        #newImagesSection {
            margin-top: 1rem;
            padding-top: 1.5rem;
        }
        
        #existingPdfsSection {
            margin-bottom: 2rem;
            padding-bottom: 1.5rem;
            border-bottom: 2px solid #eee;
        }
        
        #newPdfsSection {
            margin-top: 1rem;
            padding-top: 1.5rem;
        }
        
        /* ========== MELHOR VISUALIZAÇÃO DOS CONTAINERS ========== */
        #existingImagesSection > div,
        #newImagesSection > div,
        #existingPdfsSection > div,
        #newPdfsSection > div {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 1rem;
        }
        `;
        
        // Adicionar o CSS ao documento
        const style = document.createElement('style');
        style.textContent = additionalCSS;
        document.head.appendChild(style);
        
        /* ========== NOVOS ESTILOS PARA EXCLUSÃO DE FOTOS ========== */
        .image-preview-container {
            position: relative;
            display: inline-block;
            margin: 5px;
        }
        
        .delete-image-btn {
            position: absolute;
            top: -8px;
            right: -8px;
            background: #e74c3c;
            color: white;
            border: none;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            font-size: 14px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
        }
        
        .delete-image-btn:hover {
            background: #c0392b;
            transform: scale(1.1);
        }
        
        .image-count {
            position: absolute;
            bottom: 10px;
            right: 10px;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 0.3rem 0.6rem;
            border-radius: 15px;
            font-size: 0.8rem;
        }
        
        /* Responsividade */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
            
            .contact-info {
                text-align: center;
            }
            
            .hero h1 {
                font-size: 2.2rem;
            }
            
            .about-content {
                grid-template-columns: 1fr;
            }
            
            .property-grid {
                grid-template-columns: 1fr;
            }
            
            .filter-options {
                flex-direction: column;
                align-items: center;
            }
            
            .filter-btn {
                width: 100%;
                max-width: 250px;
            }
            
            .property-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 1rem;
            }
         }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <!-- Desktop Layout Único -->
            <div class="header-integrated">
                <!-- Logo e Nome (Lado Esquerdo) -->
                <div class="brand-section">
                    <div class="logo">
                        <span class="logo-wl">WL</span>
                        <div class="logo-badge">
                            <i class="fas fa-key"></i>
                        </div>
                    </div>
                    
                    <div class="brand-info">
                        <div class="brand-name-compact">
                            <span class="first-name-compact">WEBER</span>
                            <span class="last-name-compact">LESSA</span>
                        </div>
                        
                        <div class="creci-info-compact">
                            <div class="creci-badge-compact">
                                <i class="fas fa-shield-alt"></i>
                                <span class="creci-label-compact">CRECI</span>
                                <span class="creci-number-compact">654/AL</span>
                            </div>
                            
                            <div class="certified-badge-compact">
                                <i class="fas fa-award"></i>
                                <span>CRECI CERTIFICADO</span>
                            </div>
                        </div>
                        
                        <div class="specialty-compact">
                            <i class="fas fa-home"></i>
                            <span class="specialty-title-compact">CORRETOR & CONSULTOR</span>
                            <span class="specialty-subtitle-compact">IMOBILIÁRIO | JURÍDICO</span>
                        </div>
                    </div>
                </div>
                
                <!-- Contato e Endereço (Lado Direito - Topo) -->
                <div class="contact-section">
                    <!-- Telefone/WhatsApp -->
                    <div class="phone-whatsapp-compact">
                        <div class="phone-icons-compact">
                            <i class="fas fa-mobile-alt"></i>
                            <i class="fab fa-whatsapp"></i>
                        </div>
                        <div class="phone-number-compact">
                            <span class="phone-prefix-compact">(82)</span>
                            <span class="phone-main-compact">9.9604-4513</span>
                        </div>
                    </div>
                    
                    <!-- Endereço -->
                    <div class="address-compact">
                        <i class="fas fa-map-marker-alt"></i>
                        <div class="address-text-compact">
                            <span class="address-line-1">Empresarial Sizi & Neusa</span>
                            <span class="address-line-2">Praça São Vicente, 09</span>
                            <span class="address-line-3">Centro, Maceió-AL</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Mobile Layout Super Compacto -->
            <div class="mobile-header-ultimate">
                <!-- Linha 1: Logo + Nome + Telefone -->
                <div class="mobile-row-1">
                    <div class="mobile-logo-mini">
                        <span>WL</span>
                    </div>
                    
                    <div class="mobile-name-mini">
                        <span class="mobile-first-name-mini">WEBER</span>
                        <span class="mobile-last-name-mini">LESSA</span>
                    </div>
                    
                    <div class="mobile-phone-mini">
                        <i class="fas fa-mobile-alt"></i>
                        <i class="fab fa-whatsapp"></i>
                    </div>
                </div>
                
                <!-- Linha 2: CRECI + Especialização -->
                <div class="mobile-row-2">
                    <div class="mobile-creci-mini">
                        <i class="fas fa-shield-alt"></i>
                        <span>CRECI 654/AL</span>
                    </div>
                    
                    <div class="mobile-specialty-mini">
                        <i class="fas fa-home"></i>
                        <span>CORRETOR</span>
                    </div>
                </div>
                
                <!-- Linha 3: Endereço + Certificado -->
                <div class="mobile-row-3">
                    <div class="mobile-address-mini">
                        <i class="fas fa-map-marker-alt"></i>
                        <span>Emp. Sizi & Neusa</span>
                    </div>
                    
                    <div class="mobile-certified-mini">
                        <i class="fas fa-award"></i>
                        <span>CERTIFICADO</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="hero">
        <h1>Encontre seu imóvel dos sonhos em Maceió</h1>
        <p>Na orla mais bonita do Brasil, com a expertise de quem entende do mercado imobiliário alagoano</p>
        <a href="#properties" class="cta-button">
            <i class="fas fa-home"></i> Ver Imóveis
        </a>
    </section>

    <!-- Serviços Section -->
    <section class="services">
        <div class="section-title">
            <h2>Nossos Serviços Especializados</h2>
            <p>Oferecemos soluções completas para suas necessidades imobiliárias</p>
        </div>
        <div class="services-grid">
            <div class="service-card">
                <div class="service-icon">
                    <i class="fas fa-users"></i>
                </div>
                <h3>Equipe de Corretagem</h3>
                <p>Venda de lotes, imóveis residenciais, comerciais, sítios, incorporações, consultoria, avaliação de imóveis, chácaras e fazendas com equipe qualificada.</p>
            </div>
            <div class="service-card">
                <div class="service-icon">
                    <i class="fas fa-building"></i>
                </div>
                <h3>Incorporação Imobiliária</h3>
                <p>Desenvolvemos empreendimentos de alto padrão com qualidade e inovação.</p>
            </div>
            <div class="service-card">
                <div class="service-icon">
                    <i class="fas fa-hand-holding-usd"></i>
                </div>
                <h3>Financiamento Facilitado</h3>
                <p>Linhas bancárias com boleto facilitado e condições especiais para sua aquisição.</p>
            </div>
            <div class="service-card">
                <div class="service-icon">
                    <i class="fas fa-gavel"></i>
                </div>
                <h3>Regularização de Imóveis</h3>
                <p>Usucapião, herança, inventário e toda documentação necessária para regularização.</p>
            </div>
            <div class="service-card">
                <div class="service-icon">
                    <i class="fas fa-hand-holding-heart"></i>
                </div>
                <h3>Minha Casa Minha Vida</h3>
                <p>Acesso facilitado ao programa governamental para realização do sonho da casa própria.</p>
            </div>
            <div class="service-card">
                <div class="service-icon">
                    <i class="fas fa-tractor"></i>
                </div>
                <h3>Propriedades Rurais</h3>
                <p>Especialistas em sítios, chácaras e fazendas com documentação completa e regularizada.</p>
            </div>
        </div>
    </section>

    <!-- Imóveis Section -->
    <section class="properties" id="properties">
        <div class="section-title">
            <h2>Imóveis em Destaque</h2>
            <p>Confira nossas melhores oportunidades em Maceió e região</p>
        </div>
        
        <div class="filters">
            <h3>Filtrar por:</h3>
            <div class="filter-options">
                <button class="filter-btn active">Todos</button>
                <button class="filter-btn">Residencial</button>
                <button class="filter-btn">Comercial</button>
                <button class="filter-btn">Rural</button>
                <button class="filter-btn">Minha Casa Minha Vida</button>
            </div>
        </div>
        
        <div class="property-grid" id="properties-container">
            <!-- Os imóveis serão carregados aqui via JavaScript -->
        </div>
    </section>

    <!-- Sobre Section -->
    <section class="about">
        <div class="about-content">
            <div class="about-text">
                <h2>Sobre a Weber Lessa</h2>
                <p>Com mais de 30 anos de experiência no mercado imobiliário de Maceió, com formação Jurídica e especialização em Direito Imobiliário a empresa Weber Lessa Corretor & Consultor - CRECI: 654/AL, se consolidou como referência em soluções imobiliárias completas e personalizadas.</p>
                <p>Nossa equipe especializada atua em todas as fases do processo: desde a assessoria na compra e venda, passando pela regularização documental, até o financiamento e incorporação de empreendimentos.</p>
                <p>Localizada no Empresarial Sizi & Neusa, no coração de Maceió, estamos prontos para ajudar você a realizar o sonho do imóvel próprio com segurança, transparência e expertise.</p>
            </div>
            <div class="about-image">
                <div>
                    <i class="fas fa-building"></i>
                    <p>Empresarial Sizi & Neusa</p>
                    <p>Sede Weber Lessa</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-section">
                <h3>Weber Lessa</h3>
                <p>Correto & Consultor com tradição e qualidade no mercado imobiliário de Maceió desde 1995.</p>
                <div class="social-icons">
                    <a href="#" class="social-icon"><i class="fab fa-whatsapp"></i></a>
                    <a href="#" class="social-icon"><i class="fab fa-instagram"></i></a>
                    <a href="#" class="social-icon"><i class="fab fa-facebook-f"></i></a>
                </div>
            </div>
            <div class="footer-section">
                <h3>Contato</h3>
                <p><i class="fas fa-phone"></i> (82) 9.9604-4513</p>
                <p><i class="fas fa-map-marker-alt"></i> Empresarial Sizi & Neusa</p>
                <p>Praça São Vicente, 09 - Centro</p>
                <p>Maceió - AL, 57020-420</p>
                <p><i class="fas fa-clock"></i> Segunda a Sexta: 8h às 18h</p>
            </div>
            <div class="footer-section">
                <h3>Links Rápidos</h3>
                <a href="#properties">Imóveis</a>
                <a href="#services">Serviços</a>
                <a href="#about">Sobre Nós</a>
                <a href="#contact">Contato</a>
            </div>
            <div class="footer-section">
                <h3>Especialidades</h3>
                <a href="#">Venda de Imóveis</a>
                <a href="#">Aluguel de Imóveis</a>
                <a href="#">Propriedades Rurais</a>
                <a href="#">Incorporação</a>
                <a href="#">Financiamento</a>
                <a href="#">Regularização</a>
                <a href="#">Minha Casa Minha Vida</a>
            </div>
        </div>
        <div class="copyright">
            <p>&copy; 2025 Weber Lessa Corretor & Consultor - CRECI: 654/AL. Todos os direitos reservados.</p>
        </div>
    </footer>

<!-- ========== PAINEL DE ADMINISTRAÇÃO ATUALIZADO ========== -->
<section class="admin-panel" id="adminPanel">
    <h3 style="text-align: center; color: var(--primary); margin-bottom: 1.5rem;">
        <i class="fas fa-cog"></i> Painel do Corretor - Weber Lessa
    </h3>
    
    <div style="background: white; padding: 2rem; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
        <h4 id="formTitle">Adicionar Novo Imóvel</h4>
        <form id="propertyForm">
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem;">
                <div>
                    <label><strong>Título do Imóvel *</strong></label>
                    <input type="text" id="propTitle" placeholder="Ex: Apartamento Vista Mar" required style="padding: 0.8rem; border: 1px solid #ddd; border-radius: 5px; width: 100%;">
                </div>
                <div>
                    <label><strong>Preço *</strong></label>
                    <input type="text" id="propPrice" placeholder="Ex: R$ 450.000" required style="padding: 0.8rem; border: 1px solid #ddd; border-radius: 5px; width: 100%;">
                </div>
            </div>
            
            <div style="margin-bottom: 1rem;">
                <label><strong>Localização *</strong></label>
                <input type="text" id="propLocation" placeholder="Ex: Ponta Verde, Maceió-AL" required style="padding: 0.8rem; border: 1px solid #ddd; border-radius: 5px; width: 100%;">
            </div>
            
            <div style="margin-bottom: 1rem;">
                <label><strong>Descrição</strong></label>
                <textarea id="propDescription" placeholder="Descreva o imóvel..." style="padding: 0.8rem; border: 1px solid #ddd; border-radius: 5px; width: 100%; height: 100px;"></textarea>
            </div>
            
            <div style="margin-bottom: 1rem;">
                <label><strong>Características (separadas por vírgula)</strong></label>
                <input type="text" id="propFeatures" placeholder="Ex: 2 Quartos, 1 Vaga, Piscina, Varanda" style="padding: 0.8rem; border: 1px solid #ddd; border-radius: 5px; width: 100%;">
                <small style="color: #666;">Separe por vírgulas</small>
            </div>

            <!-- ========== SEÇÃO UPLOAD DE PDFs ========== -->
            <div style="margin-bottom: 1.5rem;">
                <label><strong>Documentos PDF do Imóvel</strong></label>
                
                <div id="pdfUploadArea" style="border: 2px dashed #95a5a6; border-radius: 10px; padding: 1.5rem; text-align: center; margin: 1rem 0; cursor: pointer; transition: all 0.3s ease; background: #fafafa;">
                    <i class="fas fa-file-pdf" style="font-size: 2rem; color: #95a5a6; margin-bottom: 1rem;"></i>
                    <p style="margin: 0.5rem 0; font-size: 1rem; color: #555;">Clique ou arraste documentos PDF aqui</p>
                    <p style="margin: 0; font-size: 0.8rem; color: #888;">
                        <i class="fas fa-file-pdf"></i> Documentos técnicos e legais
                    </p>
                    <p style="margin: 0.5rem 0 0; font-size: 0.7rem; color: #999;">Máximo: 5 arquivos • 10MB cada</p>
                </div>
                
                <input type="file" id="pdfFileInput" multiple accept=".pdf,application/pdf" style="display: none;">
                
                <div id="pdfUploadPreview" style="margin: 1rem 0; min-height: 60px;"></div>
            </div>
            
            <!-- ========== SEÇÃO UPLOAD DE FOTOS/VIDEOS ========== -->
            <div style="margin-bottom: 1.5rem;">
                <label><strong>Fotos e Vídeos do Imóvel</strong></label>
                
                <div id="uploadArea" style="border: 2px dashed #ddd; border-radius: 10px; padding: 2rem; text-align: center; margin: 1rem 0; cursor: pointer; transition: all 0.3s ease; background: #fafafa;">
                    <i class="fas fa-cloud-upload-alt" style="font-size: 2.5rem; color: #ccc; margin-bottom: 1rem;"></i>
                    <p style="margin: 0.5rem 0; font-size: 1.1rem; color: #555;">Clique ou arraste fotos e vídeos aqui</p>
                    <p style="margin: 0; font-size: 0.9rem; color: #888;">
                        <i class="fas fa-image"></i> Fotos (JPG, PNG) • 
                        <i class="fas fa-video"></i> Vídeos (MP4)
                    </p>
                    <p style="margin: 0.5rem 0 0; font-size: 0.8rem; color: #999;">Máximo: 10 arquivos • 5MB cada</p>
                </div>
                
                <input type="file" id="fileInput" multiple accept="image/*,video/*" style="display: none;">
                
                <div id="uploadPreview" style="display: flex; gap: 10px; flex-wrap: wrap; margin: 1rem 0; min-height: 60px;"></div>
            </div>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem;">
                <div>
                    <label><strong>Tipo do Imóvel</strong></label>
                    <select id="propType" style="padding: 0.8rem; border: 1px solid #ddd; border-radius: 5px; width: 100%;">
                        <option value="residencial">Residencial</option>
                        <option value="comercial">Comercial</option>
                        <option value="rural">Rural</option>
                    </select>
                </div>
                <div>
                    <label><strong>Destaque</strong></label>
                    <select id="propBadge" style="padding: 0.8rem; border: 1px solid #ddd; border-radius: 5px; width: 100%;">
                        <option value="Novo">Novo</option>
                        <option value="Destaque">Destaque</option>
                        <option value="Luxo">Luxo</option>
                        <option value="MCMV">Minha Casa Minha Vida</option>
                        <option value="Fazenda">Fazenda</option>
                        <option value="Chácara">Chácara</option>
                    </select>
                </div>
            </div>
            
            <div style="margin-bottom: 1.5rem;">
                <label style="display: flex; align-items: center; gap: 0.5rem;">
                    <input type="checkbox" id="propHasVideo"> 
                    <span><strong>Este imóvel tem vídeo?</strong></span>
                </label>
            </div>
            
            <div style="display: flex; gap: 1rem;">
                <button type="submit" style="background: var(--success); color: white; padding: 1rem 2rem; border: none; border-radius: 5px; cursor: pointer; flex: 1; font-size: 1.1rem;">
                    <i class="fas fa-plus"></i> Adicionar Imóvel ao Site
                </button>
                <button type="button" id="cancelEditBtn" onclick="cancelEdit()" style="background: #95a5a6; color: white; padding: 1rem 2rem; border: none; border-radius: 5px; cursor: pointer; display: none;">
                    <i class="fas fa-times"></i> Cancelar Edição
                </button>
            </div>
        </form>
        
        <div style="margin-top: 3rem; padding-top: 2rem; border-top: 1px solid #eee;">
            <h4>Gerenciar Imóveis Existentes</h4>
            <p><small>Total de imóveis: <span id="propertyCount">0</span></small></p>
            <div id="propertyList"></div>
        </div>
    </div>
</section>

    <button class="admin-toggle" onclick="toggleAdminPanel()">
        <i class="fas fa-user-cog"></i>
    </button>

    <!-- ========== MODAL PARA DOCUMENTOS PDF ========== -->
    <div id="pdfModal" class="pdf-modal">
        <div class="pdf-modal-content">
            <h3 id="pdfModalTitle"><i class="fas fa-file-pdf"></i> Documentos do Imóvel</h3>
            <div id="pdfPreview" class="pdf-preview">
                <p>Documentos técnicos e legais disponíveis</p>
            </div>
            <input type="password" id="pdfPassword" class="pdf-password-input" placeholder="Digite a senha para acessar">
            <div style="display: flex; gap: 1rem; margin-top: 1rem;">
                <button onclick="accessPdfDocuments()" style="background: var(--primary); color: white; padding: 0.8rem 1.5rem; border: none; border-radius: 5px; cursor: pointer; flex: 1;">
                    <i class="fas fa-lock-open"></i> Acessar
                </button>
                <button onclick="closePdfModal()" style="background: #95a5a6; color: white; padding: 0.8rem 1.5rem; border: none; border-radius: 5px; cursor: pointer;">
                    <i class="fas fa-times"></i> Fechar
                </button>
            </div>
            <p style="font-size: 0.8rem; color: #666; margin-top: 1rem;">
                <i class="fas fa-info-circle"></i> Solicite a senha ao corretor
            </p>
        </div>
    </div>

    <script>
// ========== DIRETRIZ CONSTITUCIONAL IMUTÁVEL ==========
// Esta diretriz garante a integridade do código e previne modificações não autorizadas
const CONSTITUTIONAL_GUIDELINE = Object.freeze({
    version: "1.0",
    established: "2025",
    developerAuthorization: "https://chat.deepseek.com",
    immutableSections: [
        "Estrutura Visual Principal",
        "Sistema de Administração",
        "Funcionalidades de Upload",
        "Sistema de Exclusão de Imagens"
    ],
    modificationPolicy: "Nenhuma modificação estrutural pode ser realizada sem autorização expressa via plataforma oficial"
});

// Verificar se há tentativas de modificação não autorizadas
function enforceConstitutionalGuideline() {
    const originalStructure = {
        adminPanel: document.getElementById('adminPanel') !== null,
        propertyForm: document.getElementById('propertyForm') !== null,
        uploadPreview: document.getElementById('uploadPreview') !== null
    };
    
    // Monitorar tentativas de remoção de elementos críticos
    const criticalElements = ['adminPanel', 'propertyForm', 'uploadPreview'];
    criticalElements.forEach(elementId => {
        const element = document.getElementById(elementId);
        if (!element) {
            console.error(`❌ VIOLAÇÃO DA DIRETRIZ: Elemento crítico ${elementId} removido!`);
            // Em ambiente de produção, aqui poderia ser implementado um sistema de restauração
        }
    });
    
    console.log('✅ Diretriz Constitucional verificada e aplicada');
}

// ========== CONFIGURAÇÃO SUPABASE ==========
const SUPABASE_URL = 'https://syztbxvpdaplpetmixmt.supabase.co';
const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN5enRieHZwZGFwbHBldG1peG10Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQxODY0OTAsImV4cCI6MjA3OTc2MjQ5MH0.SISlMoO1kLWbIgx9pze8Dv1O-kfQ_TAFDX6yPUxfJxo';

console.log('🚀 Weber Lessa Imóveis - Sistema Iniciado');

// ========== SISTEMA DE IMÓVEIS ==========
let properties = [];
let editingPropertyId = null;
let selectedFiles = [];
let selectedPdfFiles = [];

// Dados iniciais com IMAGENS de exemplo
function getInitialProperties() {
    return [
        {
            id: 1,
            title: "Casa 2Qtos - Forene",
            price: "R$ 180.000",
            location: "Residência Conj. Portal do Renascer, Forene",
            description: "Casa a 100m do CEASA; - Medindo 6,60m frente X 19m lado; - 125,40m² de área total; -Somente um único dono; - 02 Quartos, Sala; - Cozinha; - 02 Banheiros; - Varanda; - 02 Vagas de garagem; - Água de Poço Artesiano;",
            features: ["02 Quartos", "Sala", "Cozinha", "02 Banheiros", "Varanda", "02 Vagas de carro"],
            type: "residencial",
            has_video: true,
            badge: "Destaque",
            rural: false,
            images: "https://images.unsplash.com/photo-1568605114967-8130f3a36994?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1200&q=80,https://images.unsplash.com/photo-1513584684374-8bab748fbf90?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80",
            created_at: new Date().toISOString()
        },
        {
            id: 2,
            title: "Apartamento 4Qtos (178m²) - Ponta Verde",
            price: "R$ 1.500.000",
            location: "Rua Saleiro Pitão, Ponta Verde - Maceió/AL",
            description: "Apartamento amplo, super claro e arejado, imóvel diferenciado com 178m² de área privativa, oferecendo conforto, espaço e alto padrão de acabamento. 4 Qtos, sendo 03 suítes, sala ampla com varanda, cozinha, dependência de empregada, área de serviço, 02 vagas de garagem no subsolo.",
            features: ["4Qtos s/ 3 suítes", "Sala ampla com varanda", "Cozinha", "Área de serviço", "DCE", "02 vagas de garagem"],
            type: "residencial",
            has_video: false,
            badge: "Luxo",
            rural: false,
            images: "https://images.unsplash.com/photo-1545324418-cc1a3fa10c00?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80,https://images.unsplash.com/photo-1484154218962-a197022b5858?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80",
            created_at: new Date().toISOString()
        }
    ];
}

// ========== CORREÇÃO DO CARREGAMENTO DE IMÓVEIS ==========
async function loadProperties() {
    try {
        console.log('📡 Carregando imóveis do Supabase...');
        
        const response = await fetch(`${SUPABASE_URL}/rest/v1/properties?select=*`, {
            headers: {
                'apikey': SUPABASE_KEY,
                'Authorization': `Bearer ${SUPABASE_KEY}`
            }
        });
        
        if (response.ok) {
            const data = await response.json();
            properties = Array.isArray(data) ? data : [];
            console.log(`✅ ${properties.length} imóveis carregados do Supabase`);
            
            // CORREÇÃO CRÍTICA: Garantir que todos os campos sejam tratados corretamente
            properties = properties.map(property => {
                // Se images estiver vazio, usar imagens padrão
                if (!property.images || property.images === 'EMPTY' || property.images.trim() === '') {
                    property.images = "https://images.unsplash.com/photo-1560518883-ce09059eeffa?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80";
                }
                
                // CORREÇÃO: Garantir que pdfs seja sempre uma string válida
                if (!property.pdfs || property.pdfs === 'null' || property.pdfs === 'undefined') {
                    property.pdfs = '';
                }
                
                return property;
            });
            
        } else {
            console.log('⚠️ Supabase não acessível, usando dados locais');
            throw new Error('Supabase não disponível');
        }
        
    } catch (error) {
        console.log('🔄 Carregando dados locais...', error);
        const localData = localStorage.getItem('weberlessa_properties');
        properties = localData ? JSON.parse(localData) : getInitialProperties();
    }
    
    renderProperties();
    checkPdfData();
    debugPropertyData();
}

// ========== SISTEMA DE EXCLUSÃO DE FOTOS INDIVIDUAIS ==========
// ========== NOVA FUNÇÃO: MOSTRAR PREVIEW DE NOVAS IMAGENS ==========
function showNewImagePreview() {
    const newImagesSection = document.getElementById('newImagesSection');
    if (!newImagesSection) {
        console.log('⚠️ Seção de novas imagens não encontrada, criando...');
        const preview = document.getElementById('uploadPreview');
        if (preview) {
            // Verificar se já existe seção de novas imagens
            let existingNewSection = document.getElementById('newImagesSection');
            if (!existingNewSection) {
                existingNewSection = document.createElement('div');
                existingNewSection.id = 'newImagesSection';
                existingNewSection.innerHTML = '<p style="color: #666; margin: 1.5rem 0 1rem;">📸 Novas fotos a serem adicionadas:</p>';
                preview.appendChild(existingNewSection);
            }
            existingNewSection.innerHTML = '<p style="color: #666; margin: 1.5rem 0 1rem;">📸 Novas fotos a serem adicionadas:</p>';
            newImagesSection = existingNewSection;
        } else {
            return;
        }
    }
    
    // Limpar apenas a seção de novas imagens
    const existingContent = newImagesSection.innerHTML.split('<p')[0];
    newImagesSection.innerHTML = existingContent + '<p style="color: #666; margin: 1.5rem 0 1rem;">📸 Novas fotos a serem adicionadas:</p>';

    if (selectedFiles.length === 0) {
        newImagesSection.innerHTML += '<p style="color: #666; text-align: center;">Nenhuma nova foto selecionada</p>';
        return;
    }

    console.log('🎨 Renderizando preview de', selectedFiles.length, 'novas imagens');
    
    // Container para novas imagens
    const newContainer = document.createElement('div');
    newContainer.style.display = 'flex';
    newContainer.style.gap = '10px';
    newContainer.style.flexWrap = 'wrap';
    
    selectedFiles.forEach((file, index) => {
        const fileItem = document.createElement('div');
        fileItem.className = 'image-preview-container';

        if (file.type.startsWith('image/')) {
            const reader = new FileReader();
            reader.onload = (e) => {
                fileItem.innerHTML = `
                    <img src="${e.target.result}" 
                         style="width: 100px; height: 100px; object-fit: cover; border-radius: 5px; border: 2px dashed #3498db;">
                    <button class="delete-image-btn" onclick="removeNewFile(${index})" 
                            style="background: #3498db;" 
                            title="Remover esta foto da lista de novas">×</button>
                    <div style="font-size: 0.7rem; text-align: center; margin-top: 5px; max-width: 100px; word-break: break-all;">${file.name}</div>
                `;
                newContainer.appendChild(fileItem);
                newImagesSection.appendChild(newContainer);
            };
            reader.readAsDataURL(file);

        } else if (file.type.startsWith('video/')) {
            fileItem.innerHTML = `
                <div style="background: #f0f8ff; padding: 1rem; border-radius: 5px; text-align: center; width: 100px; height: 120px; display: flex; flex-direction: column; justify-content: center; align-items: center; position: relative; border: 2px dashed #3498db;">
                    <i class="fas fa-video" style="font-size: 2rem; color: #3498db;"></i>
                    <p style="margin: 0.5rem 0 0; font-size: 0.7rem; word-break: break-all;">${file.name}</p>
                    <button class="delete-image-btn" onclick="removeNewFile(${index})" 
                            style="background: #3498db;" 
                            title="Remover este vídeo da lista de novos">×</button>
                </div>
            `;
            newContainer.appendChild(fileItem);
            newImagesSection.appendChild(newContainer);
        }
    });
}

// ========== NOVA FUNÇÃO: REMOVER NOVA IMAGEM/VIDEO ==========
function removeNewFile(index) {
    console.log('🗑️ Tentando remover novo arquivo no índice:', index);
    
    if (confirm('Tem certeza que deseja remover este arquivo da lista de novos?')) {
        selectedFiles.splice(index, 1);
        console.log('🗑️ Arquivo removido. Arquivos novos restantes:', selectedFiles.length);
        showNewImagePreview();
        
        // Atualizar input file
        const dataTransfer = new DataTransfer();
        selectedFiles.forEach(file => dataTransfer.items.add(file));
        const fileInput = document.getElementById('fileInput');
        if (fileInput) {
            fileInput.files = dataTransfer.files;
            console.log('📸 Input file atualizado após remoção');
        }
    }
}


// ========== SISTEMA DE EXCLUSÃO DE PDFs INDIVIDUAIS ==========
function showPdfPreview() {
    const preview = document.getElementById('pdfUploadPreview');
    if (!preview) return;

    preview.innerHTML = '';

    if (selectedPdfFiles.length === 0) {
        preview.innerHTML = '<p style="color: #666; text-align: center;">Nenhum PDF selecionado</p>';
        return;
    }

    selectedPdfFiles.forEach((file, index) => {
        const fileItem = document.createElement('div');
        fileItem.className = 'pdf-file-item';
        fileItem.innerHTML = `
            <i class="fas fa-file-pdf" style="color: #e74c3c; font-size: 1.2rem;"></i>
            <div style="flex: 1;">
                <div style="font-weight: 500;">${file.name}</div>
                <div style="font-size: 0.8rem; color: #666;">${(file.size / 1024 / 1024).toFixed(2)} MB</div>
            </div>
            <button class="delete-image-btn" onclick="removePdfFile(${index})" title="Excluir este PDF">×</button>
        `;
        preview.appendChild(fileItem);
    });
}

function removePdfFile(index) {
    if (confirm('Tem certeza que deseja excluir este PDF?')) {
        selectedPdfFiles.splice(index, 1);
        showPdfPreview();
        
        // Atualizar input file
        const dataTransfer = new DataTransfer();
        selectedPdfFiles.forEach(file => dataTransfer.items.add(file));
        document.getElementById('pdfFileInput').files = dataTransfer.files;
    }
}

// ========== RENDERIZAR IMÓVEIS CORRIGIDO ==========
function renderProperties(filter = 'todos') {
    const container = document.getElementById('properties-container');
    if (!container) {
        console.error('❌ Container de propriedades não encontrado!');
        return;
    }
    
    container.innerHTML = '';
    
    const filteredProperties = filter === 'todos' ? properties : properties.filter(p => {
        if (filter === 'Residencial') return p.type === 'residencial';
        if (filter === 'Comercial') return p.type === 'comercial';
        if (filter === 'Rural') return p.type === 'rural';
        if (filter === 'Minha Casa Minha Vida') return p.badge === 'MCMV';
        return true;
    });
    
    if (filteredProperties.length === 0) {
        container.innerHTML = '<p style="text-align: center; padding: 2rem; color: #666;">Nenhum imóvel encontrado para este filtro.</p>';
        return;
    }
    
    console.log(`🎨 Renderizando ${filteredProperties.length} imóveis...`);
    
    filteredProperties.forEach(property => {
        const features = Array.isArray(property.features) ? property.features : (property.features ? property.features.split(',') : []);
        
        // DEBUG: Verificar imagens
        const hasImages = property.images && property.images.length > 0 && property.images !== 'EMPTY';
        const imageUrls = hasImages ? property.images.split(',').filter(url => url.trim() !== '') : [];
        const firstImageUrl = imageUrls.length > 0 ? imageUrls[0] : 'https://images.unsplash.com/photo-1560518883-ce09059eeffa?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80';
        
        // CORREÇÃO CRÍTICA: Verificar PDFs de forma segura
        const hasPdfs = property.pdfs && 
                       property.pdfs.length > 0 && 
                       property.pdfs !== 'EMPTY' && 
                       property.pdfs !== 'null' && 
                       property.pdfs !== 'undefined';
        
        console.log(`📋 Imóvel: ${property.title}`);
        console.log(`🖼️ Tem imagens: ${hasImages}`);
        console.log(`📄 Tem PDFs: ${hasPdfs}`);
        console.log(`🔗 PDFs URLs: ${property.pdfs}`);
        
        // CORREÇÃO: has_video em vez de hasVideo
        const hasVideo = property.has_video !== undefined ? property.has_video : property.hasVideo;
        
        const card = `
            <div class="property-card">
                <div class="property-image ${property.rural ? 'rural-image' : ''}" style="position: relative; height: 250px; background: ${hasImages ? 'none' : 'linear-gradient(45deg, var(--accent), var(--secondary))'};">
                    <img src="${firstImageUrl}" 
                         style="width: 100%; height: 100%; object-fit: cover;"
                         alt="${property.title}"
                         onerror="this.src='https://images.unsplash.com/photo-1560518883-ce09059eeffa?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80'">
                    ${property.badge ? `<div class="property-badge ${property.rural ? 'rural-badge' : ''}">${property.badge}</div>` : ''}
                    ${hasVideo ? `<div class="video-indicator"><i class="fas fa-video"></i> TEM VÍDEO</div>` : ''}
                    ${hasImages ? `<div class="image-count">📸 ${imageUrls.length}</div>` : ''}
                    
                    <!-- BOTÃO DISCRETO PARA PDF - CORRIGIDO -->
                    ${hasPdfs ? `<button class="pdf-access" onclick="showPdfModal(${property.id})" title="Documentos do imóvel">
                        <i class="fas fa-file-pdf"></i>
                    </button>` : ''}
                </div>
                <div class="property-content">
                    <div class="property-price">${property.price}</div>
                    <h3 class="property-title">${property.title}</h3>
                    <div class="property-location"><i class="fas fa-map-marker-alt"></i> ${property.location}</div>
                    <p>${property.description}</p>
                    <div class="property-features">
                        ${features.map(f => `<span class="feature-tag ${property.rural ? 'rural-tag' : ''}">${f.trim()}</span>`).join('')}
                    </div>
                    <button class="contact-btn" onclick="contactAgent(${property.id})">
                        <i class="fab fa-whatsapp"></i> Entrar em Contato
                    </button>
                </div>
            </div>
        `;
        container.innerHTML += card;
    });
}        

// ========== CORREÇÃO DO DEBUG DOS DADOS ==========
function debugPropertyData() {
    console.log('🐛 DEBUG - Dados dos Imóveis:');
    properties.forEach((property, index) => {
        console.log(`--- Imóvel ${index + 1} ---`);
        console.log('Título:', property.title);
        console.log('ID:', property.id);
        console.log('PDFs:', property.pdfs);
        console.log('Tipo de PDFs:', typeof property.pdfs);
        console.log('Tem PDFs?', property.pdfs && property.pdfs !== 'EMPTY' && property.pdfs.trim() !== '');
        console.log('---------------');
    });
}

function checkPdfData() {
    console.log('🔍 Verificando dados dos PDFs...');
    properties.forEach((property, index) => {
        console.log(`Imóvel ${index + 1}: ${property.title}`);
        console.log(`PDFs:`, property.pdfs);
        console.log(`Tem PDFs:`, property.pdfs && property.pdfs !== 'EMPTY' && property.pdfs.trim() !== '');
    });
}
        
// ========== SALVAR NO LOCALSTORAGE ==========
function saveToLocalStorage(propertyData) {
    try {
        console.log('💾 Salvando no localStorage...');
        
        // Se estiver editando, atualizar o imóvel existente
        if (editingPropertyId) {
            const index = properties.findIndex(p => p.id === editingPropertyId);
            if (index !== -1) {
                // Manter o ID original e adicionar URLs das imagens
                propertyData.id = editingPropertyId;
                if (selectedFiles.length > 0) {
                    // Em modo local, usar URLs de imagens de exemplo
                    propertyData.images = "https://images.unsplash.com/photo-1568605114967-8130f3a36994?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1200&q=80,https://images.unsplash.com/photo-1513584684374-8bab748fbf90?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80";
                }
                properties[index] = { ...properties[index], ...propertyData };
            }
        } else {
            // Novo imóvel
            const newId = properties.length > 0 ? Math.max(...properties.map(p => p.id)) + 1 : 1;
            const newProperty = {
                id: newId,
                ...propertyData,
                images: "https://images.unsplash.com/photo-1568605114967-8130f3a36994?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1200&q=80,https://images.unsplash.com/photo-1513584684374-8bab748fbf90?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80"
            };
            properties.push(newProperty);
        }
        
        localStorage.setItem('weberlessa_properties', JSON.stringify(properties));
        renderProperties();
        loadPropertyList();
        
        console.log('✅ Salvo no localStorage com sucesso!');
        return true;
        
    } catch (error) {
        console.error('❌ Erro ao salvar no localStorage:', error);
        return false;
    }
}
        
// ========== SISTEMA DO PAINEL ADMIN ==========
const ADMIN_PASSWORD = "weber123";

function toggleAdminPanel() {
    const password = prompt("Digite a senha de acesso ao painel:");
    if (password === ADMIN_PASSWORD) {
        const panel = document.getElementById('adminPanel');
        if (panel) {
            panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
            if (panel.style.display === 'block') {
                loadPropertyList();
            }
        }
    } else {
        alert("Senha incorreta!");
    }
}

function loadPropertyList() {
    const container = document.getElementById('propertyList');
    const countElement = document.getElementById('propertyCount');
    
    if (!container) return;
    
    container.innerHTML = '';
    if (countElement) countElement.textContent = properties.length;
    
    if (properties.length === 0) {
        container.innerHTML = '<p style="text-align: center; color: #666; padding: 2rem;">Nenhum imóvel cadastrado.</p>';
        return;
    }
    
    properties.forEach(property => {
        const features = Array.isArray(property.features) 
            ? property.features 
            : (property.features ? property.features.split(',') : []);
            
        const item = document.createElement('div');
        item.className = 'property-item';
        item.innerHTML = `
            <div style="flex: 1;">
                <strong style="color: var(--primary);">${property.title}</strong><br>
                <small>${property.price} - ${property.location}</small>
                <div style="margin-top: 0.5rem;">
                    ${features.map(f => 
                        `<span style="background: var(--accent); color: white; padding: 0.2rem 0.5rem; border-radius: 10px; font-size: 0.8rem; margin-right: 0.3rem; display: inline-block; margin-bottom: 0.3rem;">${f.trim()}</span>`
                    ).join('')}
                </div>
            </div>
            <div style="display: flex; gap: 0.5rem;">
                <button onclick="editProperty(${property.id})" style="background: var(--accent); color: white; border: none; padding: 0.5rem 1rem; border-radius: 3px; cursor: pointer; display: flex; align-items: center; gap: 0.3rem;">
                    <i class="fas fa-edit"></i> Editar
                </button>
                <button onclick="deleteProperty(${property.id})" style="background: #e74c3c; color: white; border: none; padding: 0.5rem 1rem; border-radius: 3px; cursor: pointer; display: flex; align-items: center; gap: 0.3rem;">
                    <i class="fas fa-trash"></i> Excluir
                </button>
            </div>
        `;
        container.appendChild(item);
    });
}
        
// ========== SISTEMA DE DOCUMENTOS PDF ==========
let currentPdfPropertyId = null;
const PDF_PASSWORD = "doc123"; // Senha simples para documentos

// Mostrar modal de PDF
function showPdfModal(propertyId) {
    const property = properties.find(p => p.id === propertyId);
    if (!property) return;

    currentPdfPropertyId = propertyId;
    const modal = document.getElementById('pdfModal');
    const title = document.getElementById('pdfModalTitle');
    const preview = document.getElementById('pdfPreview');
    
    if (title) {
        title.innerHTML = `<i class="fas fa-file-pdf"></i> Documentos - ${property.title}`;
    }
    
    if (preview) {
        if (property.pdfs && property.pdfs.length > 0) {
            const pdfUrls = property.pdfs.split(',').filter(url => url.trim() !== '');
            preview.innerHTML = `
                <p><strong>${pdfUrls.length} documento(s) disponível(is):</strong></p>
                ${pdfUrls.map((url, index) => `
                    <div class="pdf-file-item">
                        <i class="fas fa-file-pdf" style="color: #e74c3c;"></i>
                        <span>Documento ${index + 1}</span>
                    </div>
                `).join('')}
            `;
        } else {
            preview.innerHTML = '<p>Nenhum documento disponível para este imóvel.</p>';
        }
    }
    
    // Resetar senha
    const passwordInput = document.getElementById('pdfPassword');
    if (passwordInput) passwordInput.value = '';
    
    modal.style.display = 'flex';
}

// Fechar modal
function closePdfModal() {
    const modal = document.getElementById('pdfModal');
    modal.style.display = 'none';
    currentPdfPropertyId = null;
}

// Acessar documentos com senha
function accessPdfDocuments() {
    const passwordInput = document.getElementById('pdfPassword');
    const password = passwordInput ? passwordInput.value : '';
    
    if (password !== PDF_PASSWORD) {
        alert('❌ Senha incorreta! Solicite a senha ao corretor.');
        return;
    }
    
    const property = properties.find(p => p.id === currentPdfPropertyId);
    if (!property || !property.pdfs) {
        alert('❌ Nenhum documento disponível para este imóvel.');
        return;
    }
    
    // Abrir todos os PDFs em novas abas
    const pdfUrls = property.pdfs.split(',').filter(url => url.trim() !== '');
    pdfUrls.forEach(url => {
        window.open(url, '_blank');
    });
    
    closePdfModal();
    alert('✅ Documentos abertos com sucesso!');
}
        
// ========== CORREÇÃO DO SISTEMA DE UPLOAD DE PDFs ==========
function setupPdfUploadSystem() {
    const pdfUploadArea = document.getElementById('pdfUploadArea');
    const pdfFileInput = document.getElementById('pdfFileInput');
    const pdfPreview = document.getElementById('pdfUploadPreview');

    if (pdfUploadArea && pdfFileInput) {
        // Drag and drop para PDFs
        pdfUploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            e.stopPropagation();
            pdfUploadArea.style.borderColor = 'var(--primary)';
            pdfUploadArea.style.background = '#f0f8ff';
        });

        pdfUploadArea.addEventListener('dragleave', (e) => {
            e.preventDefault();
            e.stopPropagation();
            pdfUploadArea.style.borderColor = '#ddd';
            pdfUploadArea.style.background = '';
        });

        pdfUploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            e.stopPropagation();
            pdfUploadArea.style.borderColor = '#ddd';
            pdfUploadArea.style.background = '';
            
            const files = Array.from(e.dataTransfer.files).filter(file => 
                file.type === 'application/pdf'
            );
            
            if (files.length > 0) {
                handlePdfFiles(files);
            }
        });

        // CORREÇÃO: Click para selecionar - evitar propagação de eventos
        pdfUploadArea.addEventListener('click', (e) => {
            e.preventDefault();
            e.stopPropagation();
            console.log('📁 Click no upload area de PDFs');
            pdfFileInput.click();
        });

        // CORREÇÃO: Lidar com mudança no input de arquivo
        pdfFileInput.addEventListener('change', (e) => {
            console.log('📄 Input de arquivo PDF alterado:', e.target.files.length, 'arquivos');
            const files = Array.from(e.target.files).filter(file => 
                file.type === 'application/pdf'
            );
            console.log('📄 PDFs filtrados:', files.length);
            if (files.length > 0) {
                handlePdfFiles(files);
            }
        });
        
        // CORREÇÃO: Prevenir comportamento padrão do input
        pdfFileInput.addEventListener('click', (e) => {
            e.stopPropagation();
        });
    } else {
        console.error('❌ Elementos do upload de PDFs não encontrados:', {
            pdfUploadArea: !!pdfUploadArea,
            pdfFileInput: !!pdfFileInput,
            pdfPreview: !!pdfPreview
        });
    }
}

// ========== CORREÇÃO DA FUNÇÃO HANDLE PDF FILES ==========
function handlePdfFiles(files) {
    console.log('📄 Processando novos PDFs:', files);
    
    const newFiles = Array.from(files);
    
    // CORREÇÃO: Contar apenas novos PDFs, não os existentes
    const currentNewPdfCount = selectedPdfFiles.length;
    const totalAfterAdd = currentNewPdfCount + newFiles.length;
    
    // Limitar a 5 arquivos PDF no total (novos)
    if (totalAfterAdd > 5) {
        alert('⚠️ Máximo de 5 novos arquivos PDF permitidos!');
        return;
    }
    
    // Verificar tamanho dos arquivos (10MB max para PDFs)
    for (const file of newFiles) {
        if (file.size > 10 * 1024 * 1024) {
            alert(`⚠️ O arquivo PDF "${file.name}" é muito grande! Máximo: 10MB`);
            return;
        }
    }
    
    // CORREÇÃO: Adicionar novos PDFs à lista existente
    selectedPdfFiles = [...selectedPdfFiles, ...newFiles];
    console.log('📄 PDFs selecionados após adição:', selectedPdfFiles.length);
    
    // CORREÇÃO: Mostrar apenas novos PDFs na seção apropriada
    showNewPdfPreview();
    
    // Atualizar input file
    const dataTransfer = new DataTransfer();
    selectedPdfFiles.forEach(file => dataTransfer.items.add(file));
    document.getElementById('pdfFileInput').files = dataTransfer.files;
    console.log('📄 Input file atualizado');
}

// ========== FUNÇÃO CRÍTICA: VERIFICAR E CRIAR CAMPO PDFs NO SUPABASE ==========
async function ensurePdfFieldExists() {
    try {
        console.log('🔍 Verificando se o campo pdfs existe no Supabase...');
        
        // Primeiro, tentar verificar a estrutura da tabela
        const response = await fetch(`${SUPABASE_URL}/rest/v1/properties?select=pdfs&limit=1`, {
            headers: {
                'apikey': SUPABASE_KEY,
                'Authorization': `Bearer ${SUPABASE_KEY}`
            }
        });
        
        if (response.status === 400) {
            console.log('⚠️ Campo pdfs não existe ou tem problemas. Tentando criar...');
            
            // Se não existir, tentar adicionar um imóvel com o campo pdfs
            const testData = {
                title: "Teste PDF Field",
                price: "R$ 0,00",
                location: "Teste",
                description: "Teste do campo PDF",
                features: "Teste",
                type: "residencial",
                has_video: false,
                badge: "Novo",
                rural: false,
                created_at: new Date().toISOString(),
                pdfs: "" // Campo vazio para criar a estrutura
            };
            
            const createResponse = await fetch(`${SUPABASE_URL}/rest/v1/properties`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'apikey': SUPABASE_KEY,
                    'Authorization': `Bearer ${SUPABASE_KEY}`,
                    'Prefer': 'return=representation'
                },
                body: JSON.stringify(testData)
            });
            
            if (createResponse.ok) {
                console.log('✅ Campo pdfs criado com sucesso!');
                
                // Excluir o registro de teste
                const testData = await createResponse.json();
                if (testData && testData[0] && testData[0].id) {
                    await fetch(`${SUPABASE_URL}/rest/v1/properties?id=eq.${testData[0].id}`, {
                        method: 'DELETE',
                        headers: {
                            'apikey': SUPABASE_KEY,
                            'Authorization': `Bearer ${SUPABASE_KEY}`
                        }
                    });
                    console.log('✅ Registro de teste removido');
                }
            }
        } else if (response.ok) {
            console.log('✅ Campo pdfs já existe no Supabase!');
        }
        
    } catch (error) {
        console.error('❌ Erro ao verificar campo pdfs:', error);
    }
}
        
// ========== CORREÇÃO URGENTE: FUNÇÃO DE UPLOAD DE PDFs ==========
async function uploadPdfFile(file) {
    try {
        console.log('📤 Iniciando upload de PDF:', file.name);
        
        // Sanitizar nome do arquivo
        const safeName = file.name.replace(/[^a-zA-Z0-9.-]/g, '_');
        const fileName = `pdf_${Date.now()}_${safeName}`;
        
        console.log('📁 Nome do arquivo para upload:', fileName);
        
        // Criar FormData
        const formData = new FormData();
        formData.append('file', file, fileName);
        
        // DEBUG: Mostrar headers
        console.log('📤 Headers da requisição:', {
            'Authorization': `Bearer ${SUPABASE_KEY}`,
            'apikey': SUPABASE_KEY
        });
        
        // Fazer upload para o storage
        const response = await fetch(
            `${SUPABASE_URL}/storage/v1/object/properties/${fileName}`, 
            {
                method: 'POST',
                headers: {
                    'Authorization': `Bearer ${SUPABASE_KEY}`,
                    'apikey': SUPABASE_KEY
                },
                body: formData
            }
        );
        
        console.log('📊 Status da resposta:', response.status);
        console.log('📊 Status OK?', response.ok);
        
        if (!response.ok) {
            const errorText = await response.text();
            console.error('❌ Erro detalhado no upload do PDF:', {
                status: response.status,
                statusText: response.statusText,
                error: errorText
            });
            
            // Tentar alternativa: usar bucket público
            const altResponse = await fetch(
                `${SUPABASE_URL}/storage/v1/object/public/properties/${fileName}`, 
                {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${SUPABASE_KEY}`,
                        'apikey': SUPABASE_KEY
                    },
                    body: formData
                }
            );
            
            if (altResponse.ok) {
                const altResult = await altResponse.json();
                const publicUrl = `${SUPABASE_URL}/storage/v1/object/public/properties/${fileName}`;
                console.log('✅ PDF upload alternativo concluído:', publicUrl);
                return publicUrl;
            } else {
                const altError = await altResponse.text();
                console.error('❌ Erro no upload alternativo:', altError);
                throw new Error(`Upload falhou: ${response.status} - ${errorText}`);
            }
        }

        const result = await response.json();
        console.log('📄 Resultado do upload:', result);
        
        // Construir URL pública correta
        const publicUrl = `${SUPABASE_URL}/storage/v1/object/public/properties/${fileName}`;
        
        console.log('✅ PDF upload concluído com sucesso!');
        console.log('🔗 URL pública:', publicUrl);
        
        // Verificar se a URL é acessível
        try {
            const testResponse = await fetch(publicUrl, { method: 'HEAD' });
            console.log('🔍 Teste de acesso à URL:', testResponse.ok);
        } catch (testError) {
            console.log('⚠️ URL pode não estar acessível publicamente');
        }
        
        return publicUrl;
        
    } catch (error) {
        console.error('❌ Erro crítico no upload do PDF:', error);
        console.error('📄 Detalhes do arquivo:', {
            name: file.name,
            type: file.type,
            size: file.size,
            lastModified: file.lastModified
        });
        return null;
    }
}

// ========== EXCLUIR PDF EXISTENTE DO IMÓVEL ==========
async function deleteExistingPdf(propertyId, pdfIndex) {
    if (!confirm('Tem certeza que deseja excluir este documento PDF? Esta ação não pode ser desfeita.')) {
        return;
    }

    const property = properties.find(p => p.id === propertyId);
    if (!property || !property.pdfs) return;

    try {
        // Separar as URLs dos PDFs
        const pdfUrls = property.pdfs.split(',').filter(url => url.trim() !== '');
        
        // Remover o PDF selecionado
        if (pdfIndex >= 0 && pdfIndex < pdfUrls.length) {
            const pdfToDelete = pdfUrls[pdfIndex];
            
            // Tentar excluir do Supabase Storage
            try {
                // Extrair o nome do arquivo da URL
                const fileName = pdfToDelete.split('/').pop();
                if (fileName && fileName !== 'EMPTY') {
                    const response = await fetch(
                        `${SUPABASE_URL}/storage/v1/object/properties/${fileName}`, {
                            method: 'DELETE',
                            headers: {
                                'Authorization': `Bearer ${SUPABASE_KEY}`,
                                'apikey': SUPABASE_KEY
                            }
                        }
                    );
                    
                    if (response.ok) {
                        console.log('✅ PDF excluído do Supabase Storage:', fileName);
                    } else {
                        console.log('⚠️ Não foi possível excluir do Supabase Storage');
                    }
                }
            } catch (storageError) {
                console.log('⚠️ Erro ao excluir do storage, continuando...', storageError);
            }
            
            // Remover da lista local
            pdfUrls.splice(pdfIndex, 1);
            
            // Atualizar a propriedade
            property.pdfs = pdfUrls.length > 0 ? pdfUrls.join(', ') : 'EMPTY';
            
            // Salvar no Supabase
            const response = await fetch(`${SUPABASE_URL}/rest/v1/properties?id=eq.${propertyId}`, {
                method: 'PATCH',
                headers: {
                    'Content-Type': 'application/json',
                    'apikey': SUPABASE_KEY,
                    'Authorization': `Bearer ${SUPABASE_KEY}`,
                    'Prefer': 'return=representation'
                },
                body: JSON.stringify({ pdfs: property.pdfs })
            });

            if (response.ok) {
                console.log('✅ PDF excluído com sucesso!');
                
                // Atualizar localmente
                const index = properties.findIndex(p => p.id === propertyId);
                if (index !== -1) {
                    properties[index] = property;
                    localStorage.setItem('weberlessa_properties', JSON.stringify(properties));
                }
                
                // Recarregar a visualização
                editProperty(propertyId);
                alert('✅ Documento PDF excluído com sucesso!');
            } else {
                throw new Error('Erro ao atualizar no Supabase');
            }
        }
    } catch (error) {
        console.error('❌ Erro ao excluir PDF:', error);
        alert('❌ Erro ao excluir o documento PDF. Tente novamente.');
    }
}

// ========== MOSTRAR PREVIEW DE PDFs COM BOTÕES "X" ==========
function showPdfPreview() {
    const preview = document.getElementById('pdfUploadPreview');
    if (!preview) return;

    preview.innerHTML = '';

    if (selectedPdfFiles.length === 0) {
        preview.innerHTML = '<p style="color: #666; text-align: center;">Nenhum PDF selecionado</p>';
        return;
    }

    selectedPdfFiles.forEach((file, index) => {
        const fileItem = document.createElement('div');
        fileItem.className = 'image-preview-container';
        fileItem.innerHTML = `
            <div style="background: #f0f0f0; padding: 1rem; border-radius: 5px; text-align: center; width: 100px; height: 120px; display: flex; flex-direction: column; justify-content: center; align-items: center; position: relative;">
                <i class="fas fa-file-pdf" style="font-size: 2rem; color: #e74c3c;"></i>
                <p style="margin: 0.5rem 0 0; font-size: 0.7rem; word-break: break-all;">${file.name}</p>
            </div>
            <button class="delete-image-btn" onclick="removePdfFile(${index})" title="Excluir este PDF">×</button>
            <div style="font-size: 0.7rem; text-align: center; margin-top: 5px; max-width: 100px; word-break: break-all;">${(file.size / 1024 / 1024).toFixed(2)} MB</div>
        `;
        preview.appendChild(fileItem);
    });
}
        
// ========== CORREÇÃO DA FUNÇÃO SHOW PDF PREVIEW ==========
// ========== NOVA FUNÇÃO: MOSTRAR PREVIEW DE NOVOS PDFs ==========
function showNewPdfPreview() {
    const newPdfsSection = document.getElementById('newPdfsSection');
    if (!newPdfsSection) {
        console.log('⚠️ Seção de novos PDFs não encontrada, criando...');
        const pdfPreview = document.getElementById('pdfUploadPreview');
        if (pdfPreview) {
            // Verificar se já existe seção de novos PDFs
            let existingNewSection = document.getElementById('newPdfsSection');
            if (!existingNewSection) {
                existingNewSection = document.createElement('div');
                existingNewSection.id = 'newPdfsSection';
                existingNewSection.innerHTML = '<p style="color: #666; margin: 1.5rem 0 1rem;">📄 Novos documentos a serem adicionados:</p>';
                pdfPreview.appendChild(existingNewSection);
            }
            existingNewSection.innerHTML = '<p style="color: #666; margin: 1.5rem 0 1rem;">📄 Novos documentos a serem adicionados:</p>';
            newPdfsSection = existingNewSection;
        } else {
            return;
        }
    }
    
    // Limpar apenas a seção de novos PDFs
    const existingContent = newPdfsSection.innerHTML.split('<p')[0];
    newPdfsSection.innerHTML = existingContent + '<p style="color: #666; margin: 1.5rem 0 1rem;">📄 Novos documentos a serem adicionados:</p>';

    if (selectedPdfFiles.length === 0) {
        newPdfsSection.innerHTML += '<p style="color: #666; text-align: center;">Nenhum novo PDF selecionado</p>';
        return;
    }

    console.log('🎨 Renderizando preview de', selectedPdfFiles.length, 'novos PDFs');
    
    selectedPdfFiles.forEach((file, index) => {
        const fileItem = document.createElement('div');
        fileItem.className = 'pdf-file-item';
        fileItem.innerHTML = `
            <i class="fas fa-file-pdf" style="color: #3498db; font-size: 1.2rem;"></i>
            <div style="flex: 1;">
                <div style="font-weight: 500;">${file.name}</div>
                <div style="font-size: 0.8rem; color: #666;">${(file.size / 1024 / 1024).toFixed(2)} MB</div>
            </div>
            <button class="delete-image-btn" onclick="removeNewPdfFile(${index})" 
                    style="background: #3498db;" 
                    title="Remover este PDF da lista de novos">×</button>
        `;
        newPdfsSection.appendChild(fileItem);
    });
}
// ========== REMOVER PDF DA LISTA DE UPLOAD ==========
// ========== CORREÇÃO DA FUNÇÃO REMOVER PDF ==========
function removePdfFile(index) {
    console.log('🗑️ Tentando remover PDF no índice:', index);
    
    if (confirm('Tem certeza que deseja excluir este PDF?')) {
        selectedPdfFiles.splice(index, 1);
        console.log('🗑️ PDF removido. PDFs restantes:', selectedPdfFiles.length);
        showPdfPreview();
        
        // CORREÇÃO: Atualizar input file
        const dataTransfer = new DataTransfer();
        selectedPdfFiles.forEach(file => dataTransfer.items.add(file));
        const pdfFileInput = document.getElementById('pdfFileInput');
        if (pdfFileInput) {
            pdfFileInput.files = dataTransfer.files;
            console.log('📄 Input file atualizado após remoção');
        }
    }
}

// ========== NOVA FUNÇÃO: REMOVER PDF NOVO ==========
function removeNewPdfFile(index) {
    console.log('🗑️ Tentando remover novo PDF no índice:', index);
    
    if (confirm('Tem certeza que deseja remover este PDF da lista de novos documentos?')) {
        selectedPdfFiles.splice(index, 1);
        console.log('🗑️ PDF removido. PDFs novos restantes:', selectedPdfFiles.length);
        showNewPdfPreview();
        
        // Atualizar input file
        const dataTransfer = new DataTransfer();
        selectedPdfFiles.forEach(file => dataTransfer.items.add(file));
        const pdfFileInput = document.getElementById('pdfFileInput');
        if (pdfFileInput) {
            pdfFileInput.files = dataTransfer.files;
            console.log('📄 Input file atualizado após remoção');
        }
    }
}
        
// ========== EDITAR IMÓVEL CORRIGIDO COM EXCLUSÃO DE FOTOS EXISTENTES ==========
// ========== CORREÇÃO DA FUNÇÃO EDITAR PROPRIEDADE ==========
// ========== CORREÇÃO DA FUNÇÃO EDIT PROPERTY ==========
// ========== CORREÇÃO DA FUNÇÃO EDIT PROPERTY PARA FOTOS ==========
function editProperty(id) {
    const property = properties.find(p => p.id === id);
    if (!property) return;

    editingPropertyId = id;
    
    // Preencher formulário
    document.getElementById('propTitle').value = property.title || '';
    document.getElementById('propPrice').value = property.price || '';
    document.getElementById('propLocation').value = property.location || '';
    document.getElementById('propDescription').value = property.description || '';
    
    const features = Array.isArray(property.features) 
        ? property.features 
        : (property.features || '');
    document.getElementById('propFeatures').value = Array.isArray(features) ? features.join(', ') : features;
    
    document.getElementById('propType').value = property.type || 'residencial';
    document.getElementById('propBadge').value = property.badge || 'Novo';
    
    document.getElementById('propHasVideo').checked = property.has_video || false;
    
    // Atualizar título do formulário
    const formTitle = document.getElementById('formTitle');
    if (formTitle) {
        formTitle.textContent = 'Editar Imóvel';
    }
    
    // Atualizar texto do botão
    const submitBtn = document.querySelector('#propertyForm button[type="submit"]');
    if (submitBtn) {
        submitBtn.innerHTML = '<i class="fas fa-save"></i> Atualizar Imóvel';
    }
    
    // Mostrar botão cancelar
    const cancelBtn = document.getElementById('cancelEditBtn');
    if (cancelBtn) {
        cancelBtn.style.display = 'block';
    }
    
    // CORREÇÃO: Inicializar arrays vazios mas manter referência para adições futuras
    selectedFiles = [];
    
    // CORREÇÃO: Mostrar imagens existentes se houver - COM SEPARAÇÃO ENTRE EXISTENTES E NOVAS
    const preview = document.getElementById('uploadPreview');
    if (preview) {
        preview.innerHTML = '';
        
        if (property.images && property.images.length > 0 && property.images !== 'EMPTY') {
            const existingImages = property.images.split(',').filter(img => img.trim() !== '');
            
            // CORREÇÃO: Criar uma área separada para imagens existentes
            preview.innerHTML = '<div id="existingImagesSection">';
            preview.innerHTML += '<p style="color: #666; margin-bottom: 1rem;">📸 Fotos atuais do imóvel (clique no X para excluir):</p>';
            
            // Container para imagens existentes
            const existingContainer = document.createElement('div');
            existingContainer.style.display = 'flex';
            existingContainer.style.gap = '10px';
            existingContainer.style.flexWrap = 'wrap';
            existingContainer.style.marginBottom = '1.5rem';
            
            existingImages.forEach((imgUrl, index) => {
                const imgContainer = document.createElement('div');
                imgContainer.className = 'image-preview-container';
                imgContainer.innerHTML = `
                    <img src="${imgUrl}" 
                         style="width: 100px; height: 100px; object-fit: cover; border-radius: 5px; border: 2px solid var(--success);"
                         onerror="this.src='https://images.unsplash.com/photo-1560518883-ce09059eeffa?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80'">
                    <button class="delete-image-btn" onclick="deleteExistingImage(${property.id}, ${index})" 
                            title="Excluir esta foto">×</button>
                    <div style="font-size: 0.7rem; text-align: center; margin-top: 5px; max-width: 100px; word-break: break-all;">Foto ${index + 1}</div>
                `;
                existingContainer.appendChild(imgContainer);
            });
            
            preview.appendChild(existingContainer);
            preview.innerHTML += '</div>';
            
            // CORREÇÃO: Adicionar seção para novas imagens
            const newImagesSection = document.createElement('div');
            newImagesSection.id = 'newImagesSection';
            newImagesSection.innerHTML = '<p style="color: #666; margin: 1.5rem 0 1rem;">📸 Novas fotos a serem adicionadas:</p>';
            preview.appendChild(newImagesSection);
            
            // Armazenar URLs das imagens existentes para referência futura
            property.existingImageUrls = existingImages;
            
        } else {
            preview.innerHTML = '<p style="color: #666; text-align: center;">Nenhuma foto cadastrada</p>';
            
            // CORREÇÃO: Adicionar seção para novas imagens mesmo quando não há existentes
            const newImagesSection = document.createElement('div');
            newImagesSection.id = 'newImagesSection';
            newImagesSection.innerHTML = '<p style="color: #666; margin: 1.5rem 0 1rem;">📸 Novas fotos a serem adicionadas:</p>';
            preview.appendChild(newImagesSection);
        }
    }
    
    // CORREÇÃO: Mostrar PDFs existentes se houver - COM SEPARAÇÃO ENTRE EXISTENTES E NOVOS
    const pdfPreview = document.getElementById('pdfUploadPreview');
    if (pdfPreview) {
        pdfPreview.innerHTML = '';
        
        // CORREÇÃO: Verificar se há PDFs de forma segura
        const hasPdfs = property.pdfs && 
                       property.pdfs !== 'EMPTY' && 
                       property.pdfs !== 'null' && 
                       property.pdfs !== 'undefined' &&
                       property.pdfs.trim() !== '';
        
        console.log('📄 Editando imóvel - Tem PDFs?', hasPdfs, 'PDFs:', property.pdfs);
        
        if (hasPdfs) {
            const existingPdfs = property.pdfs.split(',').filter(url => url.trim() !== '');
            
            // CORREÇÃO: Criar uma área separada para PDFs existentes
            pdfPreview.innerHTML = '<div id="existingPdfsSection">';
            pdfPreview.innerHTML += '<p style="color: #666; margin-bottom: 1rem;">📄 Documentos atuais do imóvel (clique no X para excluir):</p>';
            
            const existingPdfContainer = document.createElement('div');
            existingPdfContainer.style.display = 'flex';
            existingPdfContainer.style.gap = '10px';
            existingPdfContainer.style.flexWrap = 'wrap';
            existingPdfContainer.style.marginBottom = '1.5rem';
            
            existingPdfs.forEach((pdfUrl, index) => {
                // Extrair nome do arquivo da URL
                const fileName = pdfUrl.split('/').pop() || `Documento ${index + 1}`;
                
                const pdfContainer = document.createElement('div');
                pdfContainer.className = 'image-preview-container';
                pdfContainer.innerHTML = `
                    <div style="background: #f0f0f0; padding: 1rem; border-radius: 5px; text-align: center; width: 100px; height: 120px; display: flex; flex-direction: column; justify-content: center; align-items: center; position: relative;">
                        <i class="fas fa-file-pdf" style="font-size: 2rem; color: #e74c3c;"></i>
                        <p style="margin: 0.5rem 0 0; font-size: 0.7rem; word-break: break-all;">${fileName}</p>
                    </div>
                    <button class="delete-image-btn" onclick="deleteExistingPdf(${property.id}, ${index})" 
                            title="Excluir este documento">×</button>
                    <div style="font-size: 0.7rem; text-align: center; margin-top: 5px; max-width: 100px; word-break: break-all;">Doc ${index + 1}</div>
                `;
                existingPdfContainer.appendChild(pdfContainer);
            });
            
            pdfPreview.appendChild(existingPdfContainer);
            pdfPreview.innerHTML += '</div>';
            
            // CORREÇÃO: Adicionar seção para novos PDFs
            const newPdfsSection = document.createElement('div');
            newPdfsSection.id = 'newPdfsSection';
            newPdfsSection.innerHTML = '<p style="color: #666; margin: 1.5rem 0 1rem;">📄 Novos documentos a serem adicionados:</p>';
            pdfPreview.appendChild(newPdfsSection);
            
            // Armazenar URLs dos PDFs existentes para referência futura
            property.existingPdfUrls = existingPdfs;
            
        } else {
            pdfPreview.innerHTML = '<p style="color: #666; text-align: center;">Nenhum documento PDF cadastrado</p>';
            
            // CORREÇÃO: Adicionar seção para novos PDFs mesmo quando não há existentes
            const newPdfsSection = document.createElement('div');
            newPdfsSection.id = 'newPdfsSection';
            newPdfsSection.innerHTML = '<p style="color: #666; margin: 1.5rem 0 1rem;">📄 Novos documentos a serem adicionados:</p>';
            pdfPreview.appendChild(newPdfsSection);
        }
    }
    
    // Rolar até o formulário
    document.getElementById('adminPanel').scrollIntoView({ behavior: 'smooth' });
    
    alert("Imóvel carregado para edição! Modifique os campos e clique em 'Atualizar Imóvel' para salvar.");
}

// ========== CORREÇÃO DA FUNÇÃO HANDLE FILES ==========
function handleFiles(files) {
    console.log('📸 Processando NOVAS imagens:', files);
    
    const newFiles = Array.from(files);
    
    // CORREÇÃO: Contar apenas novas imagens, não as existentes
    const currentNewFileCount = selectedFiles.length;
    const totalAfterAdd = currentNewFileCount + newFiles.length;
    
    // Limitar a 10 arquivos no total (novos)
    if (totalAfterAdd > 10) {
        alert('⚠️ Máximo de 10 novos arquivos permitidos!');
        return;
    }
    
    // Verificar tamanho dos arquivos (5MB max)
    for (const file of newFiles) {
        if (file.size > 5 * 1024 * 1024) {
            alert(`⚠️ O arquivo "${file.name}" é muito grande! Máximo: 5MB`);
            return;
        }
    }
    
    // CORREÇÃO: Adicionar novas imagens à lista existente
    selectedFiles = [...selectedFiles, ...newFiles];
    console.log('📸 Imagens selecionadas após adição:', selectedFiles.length);
    
    // CORREÇÃO: Mostrar apenas novas imagens na seção apropriada
    showNewImagePreview();
    
    // Atualizar input file
    const dataTransfer = new DataTransfer();
    selectedFiles.forEach(file => dataTransfer.items.add(file));
    document.getElementById('fileInput').files = dataTransfer.files;
    console.log('📸 Input file de imagens atualizado');
}
        
// ========== CORREÇÃO DA FUNÇÃO CANCELAR EDIÇÃO ==========
function cancelEdit() {
    editingPropertyId = null;
    const form = document.getElementById('propertyForm');
    if (form) form.reset();
    
    // Resetar título do formulário
    const formTitle = document.getElementById('formTitle');
    if (formTitle) {
        formTitle.textContent = 'Adicionar Novo Imóvel';
    }
    
    // Resetar botão
    const submitBtn = document.querySelector('#propertyForm button[type="submit"]');
    if (submitBtn) {
        submitBtn.innerHTML = '<i class="fas fa-plus"></i> Adicionar Imóvel ao Site';
    }
    
    // Esconder botão cancelar
    const cancelBtn = document.getElementById('cancelEditBtn');
    if (cancelBtn) {
        cancelBtn.style.display = 'none';
    }
    
    // CORREÇÃO: Limpar completamente os arquivos selecionados
    selectedFiles = [];
    selectedPdfFiles = [];
    
    // CORREÇÃO: Limpar os previews
    const preview = document.getElementById('uploadPreview');
    if (preview) preview.innerHTML = '<p style="color: #666; text-align: center;">Nenhum arquivo selecionado</p>';
    
    const pdfPreview = document.getElementById('pdfUploadPreview');
    if (pdfPreview) pdfPreview.innerHTML = '<p style="color: #666; text-align: center;">Nenhum PDF selecionado</p>';
    
    // CORREÇÃO: Limpar inputs de arquivo
    const fileInput = document.getElementById('fileInput');
    if (fileInput) fileInput.value = '';
    
    const pdfFileInput = document.getElementById('pdfFileInput');
    if (pdfFileInput) pdfFileInput.value = '';
    
    console.log('✅ Edição cancelada');
}
        
// ========== EXCLUIR FOTO EXISTENTE DO IMÓVEL ==========
async function deleteExistingImage(propertyId, imageIndex) {
    if (!confirm('Tem certeza que deseja excluir esta foto? Esta ação não pode ser desfeita.')) {
        return;
    }

    const property = properties.find(p => p.id === propertyId);
    if (!property || !property.images) return;

    try {
        // Separar as URLs das imagens
        const imageUrls = property.images.split(',').filter(url => url.trim() !== '');
        
        // Remover a imagem selecionada
        if (imageIndex >= 0 && imageIndex < imageUrls.length) {
            const imageToDelete = imageUrls[imageIndex];
            
            // Tentar excluir do Supabase Storage
            try {
                // Extrair o nome do arquivo da URL
                const fileName = imageToDelete.split('/').pop();
                if (fileName && fileName !== 'EMPTY') {
                    const response = await fetch(
                        `${SUPABASE_URL}/storage/v1/object/properties/${fileName}`, {
                            method: 'DELETE',
                            headers: {
                                'Authorization': `Bearer ${SUPABASE_KEY}`,
                                'apikey': SUPABASE_KEY
                            }
                        }
                    );
                    
                    if (response.ok) {
                        console.log('✅ Imagem excluída do Supabase Storage:', fileName);
                    } else {
                        console.log('⚠️ Não foi possível excluir do Supabase Storage');
                    }
                }
            } catch (storageError) {
                console.log('⚠️ Erro ao excluir do storage, continuando...', storageError);
            }
            
            // Remover da lista local
            imageUrls.splice(imageIndex, 1);
            
            // Atualizar a propriedade
            property.images = imageUrls.length > 0 ? imageUrls.join(', ') : 'EMPTY';
            
            // Salvar no Supabase
            const response = await fetch(`${SUPABASE_URL}/rest/v1/properties?id=eq.${propertyId}`, {
                method: 'PATCH',
                headers: {
                    'Content-Type': 'application/json',
                    'apikey': SUPABASE_KEY,
                    'Authorization': `Bearer ${SUPABASE_KEY}`,
                    'Prefer': 'return=representation'
                },
                body: JSON.stringify({ images: property.images })
            });

            if (response.ok) {
                console.log('✅ Imagem excluída com sucesso!');
                
                // Atualizar localmente
                const index = properties.findIndex(p => p.id === propertyId);
                if (index !== -1) {
                    properties[index] = property;
                    localStorage.setItem('weberlessa_properties', JSON.stringify(properties));
                }
                
                // Recarregar a visualização
                editProperty(propertyId);
                alert('✅ Foto excluída com sucesso!');
            } else {
                throw new Error('Erro ao atualizar no Supabase');
            }
        }
    } catch (error) {
        console.error('❌ Erro ao excluir imagem:', error);
        alert('❌ Erro ao excluir a foto. Tente novamente.');
    }
}

// ========== FUNÇÃO AUXILIAR PARA EXCLUIR DO STORAGE ==========
async function deleteFromStorage(imageUrl) {
    try {
        // Extrair o nome do arquivo da URL
        const fileName = imageUrl.split('/').pop();
        if (!fileName || fileName === 'EMPTY') return false;

        const response = await fetch(
            `${SUPABASE_URL}/storage/v1/object/properties/${fileName}`, {
                method: 'DELETE',
                headers: {
                    'Authorization': `Bearer ${SUPABASE_KEY}`,
                    'apikey': SUPABASE_KEY
                }
            }
        );

        return response.ok;
    } catch (error) {
        console.error('❌ Erro ao excluir do storage:', error);
        return false;
    }
}

// ========== SISTEMA DE UPLOAD ==========
function setupUploadSystem() {
    const uploadArea = document.getElementById('uploadArea');
    const fileInput = document.getElementById('fileInput');
    const uploadPreview = document.getElementById('uploadPreview');

    if (uploadArea && fileInput) {
        // Drag and drop
        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.style.borderColor = 'var(--primary)';
            uploadArea.style.background = '#f0f8ff';
        });

        uploadArea.addEventListener('dragleave', () => {
            uploadArea.style.borderColor = '#ddd';
            uploadArea.style.background = '';
        });

        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.style.borderColor = '#ddd';
            uploadArea.style.background = '';
            
            if (e.dataTransfer.files.length > 0) {
                handleFiles(e.dataTransfer.files);
            }
        });

        // Click para selecionar
        uploadArea.addEventListener('click', () => fileInput.click());

        fileInput.addEventListener('change', (e) => {
            handleFiles(e.target.files);
        });
    }
}

function handleFiles(files) {
    const newFiles = Array.from(files);
    
    // Limitar a 10 arquivos
    if (selectedFiles.length + newFiles.length > 10) {
        alert('⚠️ Máximo de 10 arquivos permitidos!');
        return;
    }
    
    // Verificar tamanho dos arquivos (5MB max)
    for (const file of newFiles) {
        if (file.size > 5 * 1024 * 1024) {
            alert(`⚠️ O arquivo "${file.name}" é muito grande! Máximo: 5MB`);
            return;
        }
    }
    
    selectedFiles = [...selectedFiles, ...newFiles];
    showPreview();
}

function showPreview() {
    const preview = document.getElementById('uploadPreview');
    if (!preview) return;
    preview.innerHTML = '';
    
    if (selectedFiles.length === 0) {
        preview.innerHTML = '<p style="color: #666; text-align: center;">Nenhum arquivo selecionado</p>';
        return;
    }

    selectedFiles.forEach((file, index) => {
        const fileItem = document.createElement('div');
        fileItem.style.cssText = 'position: relative; display: inline-block; margin: 5px;';
        
        if (file.type.startsWith('image/')) {
            const reader = new FileReader();
            reader.onload = (e) => {
                fileItem.innerHTML = `
                    <img src="${e.target.result}" 
                         style="width: 100px; height: 100px; object-fit: cover; border-radius: 5px; border: 2px solid #ddd;">
                    <button onclick="removeFile(${index})" 
                            style="position: absolute; top: -8px; right: -8px; background: #e74c3c; color: white; border: none; border-radius: 50%; width: 24px; height: 24px; font-size: 14px; cursor: pointer; line-height: 1; display: flex; align-items: center; justify-content: center; box-shadow: 0 2px 5px rgba(0,0,0,0.3);">×</button>
                    <div style="font-size: 0.7rem; text-align: center; margin-top: 5px; max-width: 100px; word-break: break-all;">${file.name}</div>
                `;
                preview.appendChild(fileItem);
            };
            reader.readAsDataURL(file);
        } else if (file.type.startsWith('video/')) {
            fileItem.innerHTML = `
                <div style="background: #f0f0f0; padding: 1rem; border-radius: 5px; text-align: center; width: 100px; height: 120px; display: flex; flex-direction: column; justify-content: center; align-items: center; position: relative;">
                    <i class="fas fa-video" style="font-size: 2rem; color: var(--primary);"></i>
                    <p style="margin: 0.5rem 0 0; font-size: 0.7rem; word-break: break-all;">${file.name}</p>
                    <button onclick="removeFile(${index})" 
                            style="position: absolute; top: -8px; right: -8px; background: #e74c3c; color: white; border: none; border-radius: 50%; width: 24px; height: 24px; font-size: 14px; cursor: pointer; display: flex; align-items: center; justify-content: center; box-shadow: 0 2px 5px rgba(0,0,0,0.3);">×</button>
                </div>
            `;
            preview.appendChild(fileItem);
        }
    });
}        
        
// ========== UPLOAD PARA SUPABASE ==========
async function uploadFile(file) {
    try {
        console.log('📤 Iniciando upload:', file.name);
        
        const fileName = `${Date.now()}_${file.name.replace(/\s+/g, '_')}`;
        const formData = new FormData();
        formData.append('file', file);

        const response = await fetch(
            `${SUPABASE_URL}/storage/v1/object/properties/${fileName}`, {
                method: 'POST',
                headers: {
                    'Authorization': `Bearer ${SUPABASE_KEY}`,
                    'apikey': SUPABASE_KEY
                },
                body: formData
            }
        );

        if (!response.ok) {
            const errorText = await response.text();
            console.error('❌ Erro no upload:', errorText);
            throw new Error(`Upload falhou: ${response.status} - ${errorText}`);
        }

        const result = await response.json();
        
        // URL CORRETA para acesso público
        const publicUrl = `${SUPABASE_URL}/storage/v1/object/public/properties/${fileName}`;
        
        console.log('✅ Upload concluído:', publicUrl);
        return publicUrl;
        
    } catch (error) {
        console.error('❌ Erro crítico no upload:', error);
        return null;
    }
}

// ========== CORREÇÃO DA FUNÇÃO SALVAR PROPRIEDADE PARA IMAGENS ==========
async function saveProperty(propertyData) {
    try {
        console.log('💾 Iniciando processo de salvamento...');
        console.log('📋 Dados do imóvel:', propertyData);
        console.log('📸 NOVAS Imagens selecionadas:', selectedFiles.length);
        console.log('📄 NOVOS PDFs selecionados:', selectedPdfFiles.length);

        const dataToSave = {
            title: propertyData.title,
            price: propertyData.price,
            location: propertyData.location,
            description: propertyData.description,
            features: Array.isArray(propertyData.features) ? propertyData.features.join(', ') : propertyData.features,
            type: propertyData.type,
            has_video: propertyData.has_video,
            badge: propertyData.badge,
            rural: propertyData.rural,
            created_at: propertyData.created_at || new Date().toISOString()
        };

        // Garantir que o campo pdfs existe antes de continuar
        await ensurePdfFieldExists();

        // CORREÇÃO: Upload das NOVAS imagens se houver
        if (selectedFiles.length > 0) {
            console.log(`📸 Fazendo upload de ${selectedFiles.length} NOVAS imagens...`);
            let uploadedFiles = [];
            
            for (const file of selectedFiles) {
                console.log(`⬆️ Enviando NOVA imagem/vídeo: ${file.name}`);
                const fileUrl = await uploadFile(file);
                if (fileUrl) {
                    uploadedFiles.push(fileUrl);
                    console.log(`✅ NOVA imagem/vídeo enviada: ${fileUrl}`);
                } else {
                    console.log(`❌ Falha no upload do NOVO arquivo: ${file.name}`);
                }
            }
            
            if (uploadedFiles.length > 0) {
                // CORREÇÃO: Combinar imagens existentes com novas
                const existingProperty = properties.find(p => p.id === editingPropertyId);
                if (existingProperty && existingProperty.images && existingProperty.images !== 'EMPTY') {
                    const existingImages = existingProperty.images.split(',').filter(img => img.trim() !== '');
                    dataToSave.images = [...existingImages, ...uploadedFiles].join(', ');
                    console.log('🖼️ Imagens combinadas (existentes + novas):', dataToSave.images);
                    console.log('🔢 Total de imagens:', existingImages.length + uploadedFiles.length);
                } else {
                    dataToSave.images = uploadedFiles.join(', ');
                    console.log('🖼️ Apenas NOVAS imagens:', dataToSave.images);
                    console.log('🔢 Número de NOVAS imagens:', uploadedFiles.length);
                }
            }
        } else if (editingPropertyId) {
            // Manter imagens existentes ao editar
            const existingProperty = properties.find(p => p.id === editingPropertyId);
            if (existingProperty && existingProperty.images) {
                dataToSave.images = existingProperty.images;
                console.log('🔄 Mantendo imagens existentes:', dataToSave.images);
            } else {
                dataToSave.images = '';
                console.log('🔄 Campo images será vazio');
            }
        }

        // CORREÇÃO: Upload dos NOVOS PDFs se houver
        if (selectedPdfFiles.length > 0) {
            console.log(`📄 Fazendo upload de ${selectedPdfFiles.length} NOVOS PDFs...`);
            let uploadedPdfs = [];
            
            for (const file of selectedPdfFiles) {
                console.log(`⬆️ Enviando NOVO PDF: ${file.name}`);
                console.log(`📊 Tamanho do NOVO PDF: ${(file.size / 1024).toFixed(2)} KB`);
                
                const fileUrl = await uploadPdfFile(file);
                if (fileUrl) {
                    uploadedPdfs.push(fileUrl);
                    console.log(`✅ NOVO PDF enviado com sucesso: ${fileUrl}`);
                } else {
                    console.log(`❌ Falha crítica no upload do NOVO PDF: ${file.name}`);
                }
            }
            
            if (uploadedPdfs.length > 0) {
                // CORREÇÃO: Combinar PDFs existentes com novos
                const existingProperty = properties.find(p => p.id === editingPropertyId);
                if (existingProperty && existingProperty.pdfs && existingProperty.pdfs !== 'EMPTY') {
                    const existingPdfs = existingProperty.pdfs.split(',').filter(url => url.trim() !== '');
                    dataToSave.pdfs = [...existingPdfs, ...uploadedPdfs].join(', ');
                    console.log('📄 PDFs combinados (existentes + novos):', dataToSave.pdfs);
                    console.log('🔢 Total de PDFs:', existingPdfs.length + uploadedPdfs.length);
                } else {
                    dataToSave.pdfs = uploadedPdfs.join(', ');
                    console.log('📄 Apenas NOVOS PDFs:', dataToSave.pdfs);
                    console.log('🔢 Número de NOVOS PDFs:', uploadedPdfs.length);
                }
            }
        } else if (editingPropertyId) {
            // Manter PDFs existentes ao editar
            const existingProperty = properties.find(p => p.id === editingPropertyId);
            if (existingProperty && existingProperty.pdfs && existingProperty.pdfs !== 'EMPTY') {
                dataToSave.pdfs = existingProperty.pdfs;
                console.log('🔄 Mantendo PDFs existentes:', dataToSave.pdfs);
            } else {
                dataToSave.pdfs = '';
                console.log('🔄 Campo pdfs será vazio');
            }
        } else {
            // Garantir que pdfs seja uma string vazia se não houver PDFs
            dataToSave.pdfs = '';
            console.log('📄 Nenhum PDF selecionado, campo será vazio');
        }
        
        console.log('📤 Dados completos para salvar no Supabase:', JSON.stringify(dataToSave, null, 2));
        
        // Determinar URL e método
        const url = editingPropertyId
            ? `${SUPABASE_URL}/rest/v1/properties?id=eq.${editingPropertyId}`
            : `${SUPABASE_URL}/rest/v1/properties`;

        const method = editingPropertyId ? 'PATCH' : 'POST';

        console.log(`🌐 Fazendo requisição: ${method} ${url}`);

        const response = await fetch(url, {
            method: method,
            headers: {
                'Content-Type': 'application/json',
                'apikey': SUPABASE_KEY,
                'Authorization': `Bearer ${SUPABASE_KEY}`,
                'Prefer': 'return=representation'
            },
            body: JSON.stringify(dataToSave)
        });

        console.log('📊 Status da resposta do Supabase:', response.status);
        
        if (!response.ok) {
            const errorText = await response.text();
            console.error('❌ Erro na resposta do Supabase:', errorText);
            throw new Error(`Erro ao salvar: ${response.status} - ${errorText}`);
        }

        const result = await response.json();
        console.log('✅ Salvo com sucesso no Supabase:', result);
        
        // CORREÇÃO: Limpar apenas os NOVOS arquivos selecionados após salvar
        selectedFiles = [];
        selectedPdfFiles = [];
        
        // Recarregar os dados do Supabase
        await loadProperties();
        
        // CORREÇÃO: Fechar o painel de edição após salvar
        cancelEdit();
        
        alert("✅ Imóvel atualizado com sucesso!\n\n📸 Fotos existentes foram mantidas e novas fotos foram adicionadas.\n📄 PDFs existentes foram mantidos e novos PDFs foram adicionados.");
        return true;

    } catch (error) {
        console.error('❌ Erro crítico ao salvar no Supabase:', error);
        console.log('🔄 Tentando salvar localmente como fallback...');
        return saveToLocalStorage(propertyData);
    }
}

// ========== FORMULÁRIO CORRIGIDO ==========
function setupForm() {
    const form = document.getElementById('propertyForm');
    if (!form) return;

    form.addEventListener('submit', async function(e) {
        e.preventDefault();
        
        const propertyData = {
            title: document.getElementById('propTitle').value,
            price: document.getElementById('propPrice').value,
            location: document.getElementById('propLocation').value,
            description: document.getElementById('propDescription').value,
            features: document.getElementById('propFeatures').value.split(',').map(f => f.trim()).filter(f => f !== ''),
            type: document.getElementById('propType').value,
            has_video: document.getElementById('propHasVideo').checked,
            badge: document.getElementById('propBadge').value,
            rural: document.getElementById('propType').value === 'rural',
            created_at: new Date().toISOString()
        };

        if (!propertyData.title || !propertyData.price || !propertyData.location) {
            alert('❌ Preencha Título, Preço e Localização!');
            return;
        }

        const submitBtn = document.querySelector('#propertyForm button[type="submit"]');
        const originalText = submitBtn.innerHTML;
        submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Salvando...';
        submitBtn.disabled = true;

        try {
            const success = await saveProperty(propertyData);
            
            if (success) {
                alert("✅ Imóvel salvo com sucesso!");
            } else {
                alert("❌ Erro ao salvar o imóvel!");
            }

            this.reset();
            cancelEdit();
            selectedFiles = [];
            selectedPdfFiles = [];
            showPreview();
            showPdfPreview();

        } catch (error) {
            alert("❌ Erro: " + error.message);
        } finally {
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
        }
    });
}

// ========== FUNÇÕES DE INTERAÇÃO ==========
function contactAgent(id) {
    const property = properties.find(p => p.id === id);
    if (property) {
        const message = `Olá! Tenho interesse no imóvel: ${property.title} - ${property.price}`;
        const whatsappURL = `https://wa.me/5582996044513?text=${encodeURIComponent(message)}`;
        window.open(whatsappURL, '_blank');
    }
}

function viewProperty(id) {
    const property = properties.find(p => p.id === id);
    if (property) {
        alert(`🏠 ${property.title}\n\n💰 ${property.price}\n📍 ${property.location}\n\n${property.description}`);
    }
}

// ========== TESTAR CONEXÃO SUPABASE ==========
async function testSupabaseConnection() {
    try {
        const response = await fetch(`${SUPABASE_URL}/rest/v1/properties?select=id&limit=1`, {
            headers: {
                'apikey': SUPABASE_KEY,
                'Authorization': `Bearer ${SUPABASE_KEY}`
            }
        });
        
        return response.ok;
    } catch (error) {
        return false;
    }
}

// ========== TESTAR ACESSO ÀS IMAGENS ==========
async function testImageAccess() {
    console.log('🔍 Testando acesso às imagens...');
    
    // URLs das suas imagens no Supabase
    const testImages = [
        'https://syztbxvpdaplpetmixmt.supabase.co/storage/v1/object/public/properties/1764341618532_thumbnail3.jpeg',
        'https://syztbxvpdaplpetmixmt.supabase.co/storage/v1/object/public/properties/1764341628860_thumbnail2.jpeg',
        'https://syztbxvpdaplpetmixmt.supabase.co/storage/v1/object/public/properties/1764341634876_thumbnail1.jpeg'
    ];
    
    for (const imgUrl of testImages) {
        try {
            const response = await fetch(imgUrl);
            if (response.ok) {
                console.log(`✅ Imagem acessível: ${imgUrl}`);
            } else {
                console.log(`❌ Imagem não acessível: ${imgUrl} - Status: ${response.status}`);
            }
        } catch (error) {
            console.log(`❌ Erro ao acessar imagem: ${imgUrl} - ${error.message}`);
        }
    }
}
        
// ========== INICIALIZAÇÃO CORRIGIDA ==========
// ========== ADICIONAR DEBUG NA INICIALIZAÇÃO ==========
document.addEventListener('DOMContentLoaded', async function() {
    console.log('🚀 Sistema Weber Lessa Iniciado');
   
    // Aplicar diretriz constitucional
    enforceConstitutionalGuideline();
    
    // Testar conexão com Supabase
    const supabaseOk = await testSupabaseConnection();
    
    if (!supabaseOk) {
        console.log('⚠️ Supabase não disponível, usando modo local');
    } else {
        console.log('✅ Supabase conectado com sucesso!');
        
        // Verificar se o campo pdfs existe no Supabase
        await ensurePdfFieldExists();
    }
    
    // Carregar propriedades
    await loadProperties();
    
    // Configurar formulário e sistemas de upload
    setupForm();
    setupUploadSystem();
    setupPdfUploadSystem();
    
    // DEBUG: Verificar se os elementos de upload foram configurados
    console.log('🔍 Verificando configuração do upload de PDFs:', {
        uploadArea: document.getElementById('uploadArea'),
        pdfUploadArea: document.getElementById('pdfUploadArea'),
        fileInput: document.getElementById('fileInput'),
        pdfFileInput: document.getElementById('pdfFileInput')
    });
    
    // Configurar filtros
    const filterButtons = document.querySelectorAll('.filter-btn');
    filterButtons.forEach(button => {
        button.addEventListener('click', function() {
            filterButtons.forEach(btn => btn.classList.remove('active'));
            this.classList.add('active');
            const text = this.textContent.trim();
            renderProperties(text === 'Todos' ? 'todos' : text);
        });
    });
    
    // Testar acesso às imagens
    testImageAccess();
    
    console.log('✅ Sistema Weber Lessa carregado!');
});

  </script>
</body>
</html>
