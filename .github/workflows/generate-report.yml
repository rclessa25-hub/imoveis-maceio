name: ğŸš€ Gerar RelatÃ³rio do Projeto

on:
  push:
    branches: [ main, master ]
  schedule:
    - cron: '0 0 * * 0'  # Executa todo domingo Ã  meia-noite
  workflow_dispatch:      # Permite execuÃ§Ã£o manual

permissions:
  contents: write
  pages: write
  id-token: write

jobs:
  generate-report:
    runs-on: ubuntu-latest
    
    steps:
    - name: ğŸ“¥ Checkout do repositÃ³rio
      uses: actions/checkout@v4
      with:
        fetch-depth: 0

    - name: ğŸ Configurar Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.10'

    - name: ğŸ“¦ Instalar dependÃªncias
      run: |
        pip install markdown Pygments
        sudo apt-get update
        sudo apt-get install -y tree

    - name: ğŸ“ Criar script de geraÃ§Ã£o
      run: |
        cat > generate_report.py << 'EOF'
        #!/usr/bin/env python3
        import os
        import json
        import markdown
        from datetime import datetime
        
        # Ler configuraÃ§Ã£o
        with open('report-config.json', 'r') as f:
            config = json.load(f)
        
        # Obter estrutura do projeto
        def get_structure():
            import subprocess
            try:
                result = subprocess.run(['tree', '-a', '--charset=utf-8'], 
                                      capture_output=True, text=True)
                return result.stdout if result.returncode == 0 else "Estrutura nÃ£o disponÃ­vel"
            except:
                return "Instale 'tree' para ver a estrutura completa"
        
        # Gerar relatÃ³rio Markdown
        def generate_markdown():
            content = []
            content.append(f"# ğŸ“‹ RelatÃ³rio do Projeto: {config['project_name']}")
            content.append(f"**Gerado em:** {datetime.now().strftime('%d/%m/%Y %H:%M:%S')}")
            content.append(f"**VersÃ£o:** {config.get('version', '1.0.0')}")
            content.append("")
            
            # VisÃ£o Geral
            content.append("## ğŸ¯ VisÃ£o Geral")
            content.append(config['project_description'])
            content.append("")
            
            # Links
            content.append("## ğŸ”— Links Importantes")
            for name, url in config['external_links'].items():
                content.append(f"- **{name.replace('_', ' ').title()}:** [{url}]({url})")
            content.append("")
            
            # Estrutura
            content.append("## ğŸ“ Estrutura do Projeto")
            content.append("```")
            content.append(get_structure())
            content.append("```")
            content.append("")
            
            # Features
            content.append("## âœ¨ Funcionalidades")
            for feature, enabled in config['features'].items():
                if enabled:
                    content.append(f"- âœ… {feature.replace('_', ' ').title()}")
            content.append("")
            
            # InstalaÃ§Ã£o
            content.append("## âš™ï¸ InstalaÃ§Ã£o")
            content.append("""
1. Clone o repositÃ³rio:
   ```bash
   git clone https://github.com/rclessa25-hub/imoveis-maceio.git
   cd imoveis-maceio
